<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro_installer\Traits; use Psr\Log\LoggerInterface; trait PrettyContextLoggerTrait { private ?LoggerInterface $log = null; private function initPrettyLogger(LoggerInterface $logger) : void { $this->log = new class($logger) implements LoggerInterface { public function __construct(private LoggerInterface $inner) { } public function emergency($message, array $context = []) : void { $this->inner->emergency($this->fmt($message, $context)); } public function alert($message, array $context = []) : void { $this->inner->alert($this->fmt($message, $context)); } public function critical($message, array $context = []) : void { $this->inner->critical($this->fmt($message, $context)); } public function error($message, array $context = []) : void { $this->inner->error($this->fmt($message, $context)); } public function warning($message, array $context = []) : void { $this->inner->warning($this->fmt($message, $context)); } public function notice($message, array $context = []) : void { $this->inner->notice($this->fmt($message, $context)); } public function info($message, array $context = []) : void { $this->inner->info($this->fmt($message, $context)); } public function debug($message, array $context = []) : void { $this->inner->debug($this->fmt($message, $context)); } public function log($level, $message, array $context = []) : void { $this->inner->log($level, $this->fmt($message, $context)); } private function fmt(string $message, array $context) : string { if (!($context === [])) { goto rrbY3; } return $message; rrbY3: try { $json = json_encode($context, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES); } catch (\Throwable) { $json = "\x7b\x7d"; } return $message . "\12" . $json; } }; } }