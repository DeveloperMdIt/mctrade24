<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\ioHandling; use JTL\IO\IOError; use Plugin\admorris_pro\ioHandling\IoRequestTrait; use League\Flysystem\Filesystem; use League\Flysystem\FilesystemException; use League\Flysystem\Local\LocalFilesystemAdapter; use League\Flysystem\StorageAttributes; use League\Flysystem\UnableToReadFile; class SassIO { use IoRequestTrait; private Filesystem $filesystem; public function __construct() { $adapter = new LocalFilesystemAdapter(PFAD_ROOT . "\164\x65\155\160\x6c\141\164\x65\163\57\x61\144\x6d\x6f\x72\162\151\163\x5f\160\x72\157\x2f\x73\164\171\154\x65\163\x2f\x73\x61\x73\163"); $this->filesystem = new Filesystem($adapter); } public function getUserStyles() { $response = []; $response["\x65\x72\x72\x6f\x72"] = false; $response["\165\163\145\162\x53\164\x79\x6c\x65\163"] = ''; $userStylesFiles = $this->loadScssFiles("\57\x75\x73\x65\162\x2d\x73\164\x79\x6c\145\163", false); if (!$userStylesFiles instanceof IOError) { goto E_1FG; } return $userStylesFiles; E_1FG: return collect($userStylesFiles)->map(function ($file) { $file["\146\151\154\x65\x6e\x61\x6d\x65"] = basename($file["\x70\x61\164\x68"]); return $file; })->toArray(); } public function saveScssFiles($files) { foreach ($files as $file) { $path = $file["\x70\141\164\x68"]; if (!(str_ends_with($path, "\56\x73\143\163\x73") === false)) { goto jIMwd; } throw new \Exception("\x46\151\x6c\x65\x20\x6d\x75\163\x74\x20\x62\x65\40\141\x20\56\x73\x63\x73\163\x20\146\151\154\x65\x3a\40" . $path); jIMwd: $content = $file["\x63\x6f\x6e\164\145\156\164"]; $this->filesystem->write($path, $content); H7QjW: } Z5q9s: } public function loadScssFiles($directory = "\x2f", $usePathAsKey = true) : array|IOError { $contents = []; try { foreach ($this->filesystem->listContents($directory, Filesystem::LIST_DEEP) as $file) { if (!$file->isFile()) { goto x68pR; } $path = $file->path(); if (!$usePathAsKey) { goto vJY5z; } $contents[$path] = $this->filesystem->read($path); goto JMZOi; vJY5z: $contents[] = ["\160\x61\x74\x68" => $path, "\x63\157\x6e\x74\x65\156\164" => $this->filesystem->read($path)]; x68pR: JMZOi: } XxQdD: return $contents; } catch (\Throwable $exception) { throw new \Exception("\105\x72\162\x6f\162\x20\x72\145\x61\x64\151\156\147\x20\123\x41\123\x53\x20\x66\x69\154\145\x73\x3a\x20" . $exception); } } }