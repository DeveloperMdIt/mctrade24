<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\ioHandling; use JTL\Shop; use JTL\IO\IOError; use JTL\Plugin\Helper; use JTL\Plugin\PluginLoader; use JTL\Plugin\PluginInterface; use Plugin\admorris_pro\backend\AiManager; use Plugin\admorris_pro\Logger; use Plugin\admorris_pro\Calendar; use Plugin\admorris_pro\StatusRequest; use Plugin\admorris_pro\PluginSettings; use Plugin\admorris_pro\update\Updater; use Plugin\admorris_pro\TemplateSettings; use Plugin\admorris_pro\ioHandling\Backup; use Plugin\admorris_pro\ioHandling\IconsIO; use Plugin\admorris_pro\backend\ElementsManager; use Plugin\admorris_pro\backend\SaleCountdownManager; use Plugin\admorris_pro\backend\SrcsetGenerator; use Plugin\admorris_pro\ConsentManagerIntegration; use Plugin\admorris_pro\Models\RewardPointsSettings; use Plugin\admorris_pro\Models\ThreeSixtyImageSettings; use Plugin\admorris_pro\pluginSettings\PluginSettingsNew; use Plugin\admorris_pro\controller\ThreeSixtyImageController; use Plugin\admorris_pro\Models\EnhancedEcommerceTrackingModel; use Plugin\admorris_pro\update\bs3to4Migration\MigrationAssistant; use Plugin\admorris_pro\ioHandling\cookieNoticePro\CookieNoticePro; use Plugin\admorris_pro\enhancedEcommerceTracking\EnhancedEcommerceConsent; use Plugin\admorris_pro\ioHandling\cookieNoticePro\CookieNoticeProSettings; use Plugin\admorris_pro\ioHandling\rewardPoints\RewardPointsCustomerGroupSettings; use Plugin\admorris_pro\LoggerTrait; use Plugin\admorris_pro\search\SearchApi; class AdminIoRequests { use LoggerTrait; public function __construct(private PluginInterface $oPlugin) { $this->initLogger(); } public function register($args) { if (!(!isset($args["\x72\145\x71\165\x65\x73\x74"]) || !isset($args["\151\157"]))) { goto TGevH; } return "\x45\x72\162\157\162\x3a\x20\x46\x65\150\x6c\x65\162\x20\x62\145\x69\x20\x41\112\x41\x58\x20\122\x65\x71\x75\x65\x73\x74\40\x56\x65\162\x61\162\x62\145\151\164\x75\x6e\x67"; TGevH: $oPlugin = $this->oPlugin; require_once $oPlugin->getPaths()->getFrontendPath() . "\155\141\x69\x6c\143\150\151\x6d\160\57\143\x6f\x6e\x6e\145\x63\164\151\x6f\x6e\56\x70\x68\160"; $adminPath = $oPlugin->getPaths()->getAdminPath(); require_once $adminPath . "\x73\x6c\x69\x64\145\x72\x2f\163\x6c\x69\x64\x65\162\x5f\162\145\x71\x75\x65\163\164\x5f\150\141\x6e\144\x6c\x69\156\x67\56\160\150\160"; require_once $adminPath . "\155\141\x72\x6b\x65\x74\x69\x6e\x67\x2f\x6d\x61\162\153\145\164\x69\156\147\x5f\x70\165\x73\x68\137\x6e\157\164\x69\146\x69\143\x61\164\x69\x6f\x6e\x2e\x70\150\x70"; require_once $adminPath . "\x6d\x61\x72\153\145\164\x69\x6e\147\x2f\155\141\162\x6b\145\x74\151\156\147\x5f\160\x6f\160\x75\x70\x5f\x6d\141\156\141\x67\145\162\56\160\x68\160"; require_once $adminPath . "\x6d\141\x72\x6b\145\164\x69\x6e\x67\57\155\141\162\153\x65\164\151\156\147\x5f\x6d\x61\x69\x6c\143\150\x69\155\160\x2e\160\x68\160"; Shop::set("\x61\x64\x6d\157\162\x72\151\163\x50\162\157\55\x73\145\164\x74\151\x6e\147\163", (new PluginSettings())->load()); $io = $args["\x69\157"]; $request = $args["\162\x65\161\x75\145\x73\164"]; try { $updater = new Updater($this->oPlugin, Shop::Container()->getDB(), Shop::Container()->getCache()); $io->register("\141\x64\155\125\x70\x64\x61\164\145\120\154\165\147\x69\x6e", $updater->request(...)); } catch (\Throwable $th) { Shop::Container()->getLogService()->error($th->getMessage()); } try { goto VuQ98; VuQ98: $io->register("\141\x64\155\107\x65\x74\120\157\160\125\160\163", "\x50\x6c\165\x67\151\156\x5c\x61\144\x6d\x6f\162\162\x69\163\x5f\160\162\157\x5c\x61\144\155\107\x65\164\120\157\x70\125\x70\163"); $io->register("\141\144\155\x53\141\166\145\120\157\160\125\160\x73", "\120\x6c\165\x67\x69\156\134\141\x64\x6d\157\x72\x72\x69\x73\x5f\x70\x72\x6f\x5c\x61\x64\155\x53\x61\x76\145\x50\157\x70\125\160\x73"); $io->register("\141\x64\x6d\103\x6f\160\x79\x50\157\160\125\x70", "\x50\154\165\147\x69\156\134\x61\x64\155\157\162\162\151\163\x5f\x70\x72\x6f\x5c\141\144\155\103\157\x70\171\x50\157\x70\x55\160"); $io->register("\141\144\x6d\101\x64\x64\120\x6f\x70\x55\x70", "\120\154\165\x67\x69\x6e\x5c\x61\x64\155\x6f\162\x72\151\x73\x5f\x70\x72\157\x5c\x61\144\155\101\144\144\x50\157\160\125\x70"); $io->register("\141\x64\155\104\145\x6c\x65\164\x65\120\x6f\x70\125\x70", "\x50\x6c\x75\x67\151\156\134\141\144\x6d\157\162\162\151\163\137\x70\162\x6f\134\x61\144\155\104\145\154\145\x74\x65\x50\x6f\x70\125\x70"); $io->register("\x61\144\155\107\x65\164\120\157\160\x55\x70\x46\x69\154\x74\145\162", "\x50\x6c\x75\x67\x69\156\x5c\141\144\x6d\x6f\162\x72\151\x73\137\x70\162\x6f\x5c\141\144\155\107\145\x74\120\x6f\160\x55\x70\106\x69\154\164\145\162"); $io->register("\141\144\155\123\141\166\145\120\x6f\x70\125\160\106\x69\154\164\145\x72", "\120\154\x75\147\x69\156\134\x61\144\155\157\x72\x72\151\x73\137\160\x72\157\134\x61\x64\x6d\123\141\166\x65\120\x6f\160\x55\x70\106\151\154\x74\145\162"); $io->register("\141\x64\155\x44\145\154\x65\x74\145\x50\x6f\160\x55\160\x46\151\154\x74\145\x72", "\x50\154\165\x67\x69\x6e\x5c\141\144\x6d\x6f\162\x72\151\163\137\x70\162\157\x5c\141\x64\x6d\104\145\x6c\x65\164\x65\x50\x6f\x70\x55\x70\106\x69\x6c\164\x65\162"); $aiManager = new AiManager(); $io->register("\141\144\155\x41\x69\x4d\141\156\x61\x67\145\162", [$aiManager, "\162\x65\161\x75\x65\163\164"]); goto N20Co; PUltC: $io->register("\x61\x64\x6d\x49\143\x6f\156\163", [$iconsIO, "\x72\x65\161\x75\145\x73\x74"]); try { $srcsetGenerator = new SrcsetGenerator(); $io->register("\x61\144\x6d\107\145\x6e\x65\x72\141\164\x65\111\x6d\141\x67\145\123\162\x63\x73\145\164", [$srcsetGenerator, "\162\145\161\165\x65\163\x74"]); } catch (\Throwable $th) { $this->log->error($th->getMessage()); } try { $io->register("\x70\x6c\165\x67\x69\x6e\x53\145\164\164\x69\156\147\163\x4e\x65\x77", [PluginSettingsNew::class, "\162\145\x71\165\145\163\x74"]); $io->register("\x61\x64\x6d\122\x65\147\151\163\x74\145\x72\103\x6f\x6e\163\145\156\164\x49\x74\x65\155", [ConsentManagerIntegration::class, "\x72\145\x71\165\145\x73\164"]); $io->register("\141\x64\x6d\103\x6f\157\x6b\151\145\116\x6f\x74\x69\143\x65\120\162\157", [CookieNoticePro::class, "\162\x65\x71\x75\x65\163\x74"]); $io->register("\x61\144\x6d\103\157\x6f\x6b\x69\145\x4e\157\164\x69\x63\145\x50\x72\x6f\x53\x65\x74\164\151\x6e\147\x73", [CookieNoticeProSettings::class, "\162\145\161\165\145\x73\164"]); $io->register("\x61\144\x6d\x52\145\167\141\x72\x64\x50\x6f\x69\x6e\x74\163\123\145\164\x74\151\156\147\163", [RewardPointsSettings::class, "\x72\145\161\x75\145\x73\164"]); $io->register("\141\144\155\x52\145\x77\x61\x72\144\x50\157\x69\x6e\164\x73\103\165\163\x74\157\155\x65\162\107\162\157\165\160\123\145\x74\164\151\x6e\147\x73", [RewardPointsCustomerGroupSettings::class, "\x72\145\x71\x75\145\x73\164"]); $io->register("\x61\144\x6d\122\x65\x77\141\162\144\120\157\x69\156\164\163\124\162\141\156\x73\141\x63\x74\151\157\x6e", [new \Plugin\admorris_pro\ioHandling\rewardPoints\RewardPointsIO(), "\x72\x65\x71\165\x65\163\x74"]); $io->register("\141\144\x6d\105\x6e\x68\141\156\x63\x65\144\x45\x63\157\x6d\155\145\162\x63\145\123\x65\164\x74\151\156\147\163", [EnhancedEcommerceTrackingModel::class, "\x72\145\x71\x75\x65\x73\164"]); $io->register("\141\x64\x6d\105\156\x68\x61\156\143\x65\x64\105\143\157\155\x6d\x65\162\143\145\x43\x6f\x6e\x73\x65\156\x74", [EnhancedEcommerceConsent::class, "\150\141\156\x64\x6c\145\x43\x6f\156\x73\x65\156\x74"]); $io->register("\x61\x64\155\124\x68\162\x65\145\x53\x69\170\x74\x79\x49\155\x61\x67\145\123\145\164\164\151\x6e\x67\x73", [ThreeSixtyImageSettings::class, "\x72\145\161\165\145\x73\164"]); $io->register("\x61\144\155\x54\150\162\x65\145\x53\151\170\x74\171\x49\155\x61\x67\x65\106\157\x6c\x64\x65\162\x73\101\156\x64\106\x69\154\145\154\151\x73\x74\163", [ThreeSixtyImageController::class, "\x67\145\x6e\145\x72\141\x74\145\x46\x6f\x6c\x64\145\162\x73\101\x6e\x64\x46\151\154\145\x6c\x69\x73\x74\x73"]); $io->register("\141\x64\155\123\x61\x73\163", [new SassIO(), "\162\145\161\x75\145\x73\x74"]); $io->register("\x61\144\155\102\x6f\157\x74\163\164\162\141\x70\x34\115\x69\147\162\141\x74\x69\157\x6e", (new MigrationAssistant())->run(...)); $io->register("\141\x64\155\x49\156\x73\x74\x61\x6c\154\x65\x64", function () use($oPlugin) { try { $db = Shop::Container()->getDB(); $cache = Shop::Container()->getCache(); $loader = new PluginLoader($db, $cache); $pluginBootstrap = Helper::bootstrap($oPlugin->getID(), $loader); $pluginBootstrap->installed(); return "\x73\165\143\143\145\163\x73"; } catch (\Throwable $e) { return new IOError("\x45\162\162\157\162\40\x69\156\x20" . get_called_class(), 200, [(string) $e]); } }); } catch (\Throwable $th) { Shop::Container()->getLogService()->error($th->getMessage()); } goto puROI; g6pGE: $io->register("\x61\144\x6d\x53\x61\166\x65\105\154\145\x6d\x65\x6e\x74\x46\x69\x6c\164\x65\x72", [$marketingElementsManager, "\163\x61\x76\x65\106\151\154\x74\145\162"]); $io->register("\x61\x64\x6d\x44\145\154\145\x74\145\105\x6c\x65\x6d\x65\156\x74\x46\x69\x6c\164\x65\162", [$marketingElementsManager, "\x64\x65\154\x65\x74\145\x46\x69\x6c\x74\145\x72"]); $io->register("\150\x61\x6e\x64\x6c\145\123\x6c\x69\144\x65\162", "\x50\x6c\x75\x67\x69\156\x5c\141\x64\155\157\162\x72\151\x73\137\160\x72\157\x5c\x68\x61\156\x64\154\145\123\x6c\151\144\x65\x72"); $io->register("\150\141\156\x64\154\x65\x47\x65\x74\123\154\x69\144\x65\x72", "\120\x6c\165\x67\151\x6e\x5c\x61\x64\x6d\x6f\162\162\x69\x73\137\160\162\157\x5c\150\x61\156\x64\x6c\145\x47\x65\164\x53\x6c\x69\144\x65\x72"); $io->register("\150\x61\156\144\x6c\145\123\x6c\x69\x64\x65\162\103\157\160\x79", "\x50\154\165\147\151\156\134\141\x64\155\157\162\162\151\x73\137\x70\x72\x6f\x5c\150\x61\156\144\154\145\123\x6c\151\x64\145\x72\x43\x6f\x70\x79"); $io->register("\x67\145\164\x53\154\x69\x64\x65\163", "\120\x6c\x75\147\151\156\x5c\x61\144\x6d\x6f\x72\x72\151\x73\137\160\162\x6f\x5c\x67\145\x74\x53\154\x69\144\145\x73"); $io->register("\x73\141\166\x65\x53\x6c\151\x64\145\163", "\120\x6c\165\147\151\x6e\134\x61\144\155\x6f\162\162\151\163\137\160\x72\x6f\x5c\x73\141\x76\x65\x53\x6c\151\144\x65\163"); $io->register("\141\x64\x6d\120\x6c\x75\x67\151\x6e\123\x65\x74\164\x69\x6e\x67\x73", [new PluginSettings(), "\162\145\161\x75\145\163\x74"]); $io->register("\141\144\x6d\x54\x65\x6d\160\154\x61\x74\x65\x53\145\164\164\151\x6e\x67\x73", [new TemplateSettings($this->oPlugin, Shop::Container()->getDB(), Shop::Container()->getCache()), "\x72\145\161\x75\x65\163\x74"]); $saleCountdownManager = new SaleCountdownManager(); goto mxtk1; N20Co: $io->register("\141\x64\x6d\125\160\x6c\157\141\x64\x46\151\x6c\145\x73", [$aiManager, "\x75\160\154\x6f\x61\x64\106\151\x6c\x65\163"]); $io->register("\x61\144\155\104\145\154\145\164\x65\x41\111\x53\x6c\x69\144\x65\162", [$aiManager, "\144\x65\154\145\164\145\x41\x49\123\x6c\151\144\x65\x72"]); $io->register("\141\x64\155\123\145\164\x4c\141\156\147\x75\141\147\x65\x56\x61\162\151\141\x62\x6c\x65\x73", [$aiManager, "\x73\x65\x74\x4c\x61\156\x67\x75\x61\x67\x65\126\x61\x72\x69\141\x62\x6c\x65\163"]); $marketingElementsManager = new ElementsManager(); $io->register("\x61\144\x6d\115\x61\162\x6b\145\164\x69\x6e\147\105\x6c\145\155\x65\x6e\x74\x73", $marketingElementsManager->request(...)); $io->register("\141\144\x6d\107\x65\x74\105\x6c\145\155\145\156\164\x73", [$marketingElementsManager, "\x67\145\x74\x45\154\145\155\145\x6e\164\163"]); $io->register("\x61\x64\x6d\x53\x61\166\145\105\154\145\x6d\x65\156\x74\x73", [$marketingElementsManager, "\163\x61\166\x65\x45\x6c\x65\155\x65\x6e\164\163"]); $io->register("\x61\144\x6d\101\x64\144\105\x6c\x65\x6d\x65\x6e\x74", [$marketingElementsManager, "\x61\144\144"]); $io->register("\141\144\155\x44\x65\154\145\164\145\x45\x6c\x65\155\145\x6e\164", [$marketingElementsManager, "\x64\145\x6c\x65\164\145"]); $io->register("\141\144\x6d\103\x6f\x70\171\105\154\145\155\145\x6e\164", [$marketingElementsManager, "\143\157\160\171"]); goto M_W7A; M_W7A: $io->register("\141\144\155\111\155\x70\x6f\x72\x74\x45\154\x65\x6d\x65\156\164\163", [$marketingElementsManager, "\x69\x6d\x70\157\162\164"]); $io->register("\x61\144\155\x45\x78\x70\157\x72\x74\x45\x6c\145\x6d\x65\156\164", [$marketingElementsManager, "\145\170\x70\x6f\162\164"]); $io->register("\141\144\155\105\x78\x70\x6f\162\164\101\x6c\154\x45\154\145\155\145\156\164\163", [$marketingElementsManager, "\x65\x78\160\157\x72\164\x41\154\154"]); $io->register("\141\144\155\125\x70\144\141\x74\x65\x41\x63\x74\151\x76\145\105\154\145\155\x65\156\x74", [$marketingElementsManager, "\x75\x70\144\141\164\145\101\x63\164\x69\x76\x65"]); $io->register("\x61\x64\155\x43\162\x65\141\x74\145\105\154\145\155\x65\156\x74\103\141\164\x65\147\x6f\162\171", [$marketingElementsManager, "\143\x72\x65\x61\164\145\103\141\164\145\147\157\162\171"]); $io->register("\x61\x64\155\x44\x65\154\145\164\x65\105\154\x65\x6d\x65\x6e\x74\x43\x61\164\x65\147\x6f\162\171", [$marketingElementsManager, "\x64\145\154\x65\x74\x65\103\x61\164\x65\x67\x6f\162\171"]); $io->register("\141\x64\155\x55\x70\x64\x61\164\x65\x45\x6c\x65\x6d\145\156\164\x43\x61\164\145\x67\157\x72\171\116\x61\x6d\x65", [$marketingElementsManager, "\x75\160\144\x61\164\145\103\141\164\145\147\157\x72\x79\x4e\x61\155\145"]); $io->register("\141\144\155\124\x6f\x67\147\x6c\x65\105\154\x65\x6d\x65\156\164\103\x61\164\x65\x67\157\162\x79\101\x63\x74\x69\x76\x65", [$marketingElementsManager, "\164\x6f\147\147\x6c\x65\x43\x61\x74\x65\x67\157\162\171\x41\143\164\x69\x76\x65"]); $io->register("\x61\144\x6d\x47\145\164\x45\154\x65\155\145\156\164\103\x61\x74\x65\x67\x6f\162\x69\x65\163", [$marketingElementsManager, "\x67\x65\164\103\141\164\145\x67\157\162\151\145\x73"]); $io->register("\x61\144\155\107\145\164\x45\x6c\x65\x6d\x65\x6e\164\106\151\154\164\145\162", [$marketingElementsManager, "\147\145\164\x46\151\154\164\145\x72"]); goto g6pGE; mxtk1: $io->register("\141\144\x6d\x53\x61\154\x65\103\157\x75\x6e\x74\144\157\x77\x6e\115\x61\156\x61\147\145\162", $saleCountdownManager->request(...)); $io->register("\141\x64\x6d\x53\141\x76\145\101\x64\166\145\156\x74\x43\x61\154\x65\156\144\x61\x72", Calendar::ioSave(...)); $io->register("\141\144\155\x41\x63\x74\x69\166\145\x50\141\143\153\x61\147\x65\x73", [StatusRequest::class, "\x67\x65\164\x41\x63\164\151\166\x65\120\x61\143\153\x61\x67\x65\163\x52\145\x71\x75\x65\x73\x74"]); $backup = new Backup($oPlugin); $io->register("\x61\x64\155\102\141\143\153\x75\160", [$backup, "\162\x65\161\165\x65\163\x74"]); $io->register("\141\144\x6d\107\145\164\x4d\x61\x69\x6c\103\x68\x69\x6d\160\x4c\x69\163\164\163", "\x50\x6c\x75\147\x69\156\134\141\144\155\x6f\162\162\151\x73\x5f\160\162\157\x5c\141\144\155\107\x65\164\115\141\x69\154\x43\x68\x69\x6d\160\x4c\151\163\x74\163"); $io->register("\x61\x64\x6d\115\x61\151\x6c\x43\x68\151\x6d\160\124\162\141\156\163\146\x65\162\117\x72\144\145\162\x73", "\120\x6c\x75\x67\x69\x6e\134\141\144\x6d\157\162\x72\151\x73\x5f\160\x72\157\x5c\141\x64\x6d\x4d\141\x69\154\x43\x68\151\x6d\x70\x54\162\141\x6e\163\x66\145\162\117\162\144\145\162\163"); $io->register("\x61\x64\155\x4d\141\x69\154\103\150\151\155\160\124\x72\x61\x6e\x73\146\145\x72\123\165\142\x73\x63\162\x69\142\145\x72\x73", "\x50\154\165\x67\x69\156\x5c\x61\x64\155\157\162\162\x69\163\137\x70\x72\x6f\x5c\x61\x64\155\115\x61\151\x6c\103\x68\151\155\160\x54\162\x61\x6e\x73\x66\x65\x72\x53\165\x62\163\143\x72\x69\x62\x65\x72\x73"); $io->register("\162\x75\144\162\137\155\141\x69\x6c\x63\x68\151\155\160\137\x63\x75\162\x6c\x5f\143\157\156\x6e\145\143\x74", "\x50\154\x75\x67\151\x6e\134\x61\144\155\157\162\162\x69\x73\x5f\x70\162\x6f\134\162\165\x64\162\x5f\155\x61\x69\154\x63\150\x69\x6d\160\137\x63\165\x72\154\x5f\143\x6f\156\156\145\143\164"); $iconsIO = new IconsIO(Shop::Container()->getDB()); goto PUltC; puROI: } catch (\Exception $e) { $io->respondAndExit(new IOError($e)); } } }