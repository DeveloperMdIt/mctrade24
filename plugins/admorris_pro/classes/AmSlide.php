<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro; use JTL\Shop; use JTL\DB\ReturnType; use JTL\Helpers\Text; use stdClass; class AmSlide { public $id = 0; public $sliderId = 0; public $showOnDesktop; public $showOnMobile; public $title = ''; public $content = ''; protected $text = ''; public $extraText = ''; public $altTag = ''; public $sort = 0; public $transition = ''; public $template; public $image = ''; public $thumbnail = ''; public $video; public $mediaType = "\151\155\141\x67\x65"; public $videoType; public $bgColor; public $buttonEnabled; public $buttonText; public $buttonHoverTextColor; public $separatorLine; public $separatorLineLength; public $link; public $kenBurns; public $kenBurnsAnimation; public $kenBurnsDuration; public $absoluteImage = ''; public $absoluteThumbnail = ''; public $textAlignment; public $contentPosition; public $textColor; public $imagePosH = "\x63\145\156\164\x65\162"; public $imagePosV = "\143\x65\x6e\x74\145\162"; private function __clone() { } public function load($sliderId = 0, $id = 0) { if (!((int) $sliderId > 0 || !empty($this->sliderId) && (int) $this->sliderId > 0 && (int) $id > 0 || !empty($this->id) && (int) $this->id > 0)) { goto V14YN; } if (!(empty($sliderId) || (int) $sliderId === 0)) { goto Nu6YH; } $sliderId = $this->sliderId; Nu6YH: if (!(empty($id) || (int) $id === 0)) { goto depu6; } $id = $this->id; depu6: $oSlide = Shop::Container()->getDB()->select("\x78\160\154\165\147\151\x6e\137\141\x64\155\157\x72\162\x69\163\x5f\160\162\157\x5f\163\154\151\144\x65", "\x69\x64", (int) $id); if (!\is_object($oSlide)) { goto maeUy; } $cSlide_arr = (array) $oSlide; $this->set($cSlide_arr); return true; maeUy: V14YN: return false; } public function set(array $cData_arr) { $cObjectFields_arr = get_class_vars("\120\154\165\147\x69\156\x5c\141\x64\155\x6f\162\x72\x69\163\137\160\162\157\x5c\101\x6d\123\154\151\x64\x65"); foreach ($cObjectFields_arr as $cField => $cValue) { if (!isset($cData_arr[$cField])) { goto lUvPr; } $this->{$cField} = $cData_arr[$cField]; lUvPr: kJuwq: } c_0_d: $this->setAbsoluteImagePaths(); return $this; } private function setAbsoluteImagePaths() { $basePath = Shop::getImageBaseURL(); if (str_starts_with($this->image, "\102\x69\x6c\144\145\x72\x2f")) { goto L1wTX; } $this->absoluteImage = $basePath . $this->image; $this->absoluteThumbnail = $basePath . $this->thumbnail; goto OXc7g; L1wTX: $this->absoluteImage = $basePath . \PFAD_MEDIAFILES . $this->image; $this->absoluteThumbnail = $basePath . $this->thumbnail; OXc7g: return $this; } public function save() { goto xy3_y; fgekT: return empty($this->id) ? $this->append() : $this->update() > 0; goto r17qQ; fXWGS: goto JEn8T; f8VVX: $this->setThumbnail(\PFAD_MEDIAFILES . "\x42\x69\154\x64\x65\x72\x2f\56\164\155\142\57" . \basename($this->getThumbnail())); JEn8T: $path = \parse_url(Shop::getURL() . "\57", \PHP_URL_PATH); if (!str_starts_with($this->image, $path)) { goto U1HMm; } $this->image = \ltrim(\substr($this->image, \mb_strlen($path)), "\57"); U1HMm: axIi3: bN3hm: goto fgekT; xy3_y: $this->getTitle() && $this->setTitle(preg_replace("\x23\x3c\163\x63\162\151\160\x74\50\56\52\77\51\76\x28\56\x2a\x3f\51\74\57\163\143\x72\x69\160\x74\76\x23\x69\x73", '', $this->getTitle())); $this->getContent() && $this->setContent(preg_replace("\x23\74\x73\x63\162\151\x70\x74\x28\x2e\52\x3f\x29\76\x28\56\52\x3f\x29\74\x2f\163\143\162\x69\x70\164\76\x23\x69\163", '', $this->getContent())); $this->getExtraText() && $this->setExtraText(preg_replace("\x23\x3c\x73\143\x72\151\x70\164\x28\x2e\52\x3f\x29\x3e\50\x2e\52\x3f\x29\x3c\x2f\x73\143\162\151\160\x74\76\x23\x69\163", '', $this->getExtraText())); $this->getButtonText() && $this->setButtonText(preg_replace("\x23\74\163\143\162\x69\x70\164\50\x2e\52\x3f\51\x3e\x28\56\x2a\77\51\74\x2f\x73\143\162\x69\160\164\76\x23\151\163", '', $this->getButtonText())); $this->getAltTag() && $this->setAltTag(preg_replace("\43\74\163\143\x72\x69\160\164\x28\56\52\x3f\51\x3e\50\x2e\x2a\77\x29\x3c\57\x73\x63\162\x69\160\164\76\x23\151\x73", '', $this->getAltTag())); $this->getLink() && $this->setLink(preg_replace("\x23\74\x73\143\162\x69\x70\164\x28\x2e\52\x3f\x29\x3e\x28\56\x2a\77\51\x3c\57\163\x63\162\x69\x70\x74\x3e\x23\151\163", '', $this->getLink())); if (empty($this->image)) { goto bN3hm; } if (empty($this->image)) { goto axIi3; } if (str_starts_with($this->image, "\102\151\154\x64\145\x72\57")) { goto f8VVX; } $this->setThumbnail(\STORAGE_OPC . "\x2e\x74\x6d\x62\x2f" . \basename($this->getThumbnail())); goto fXWGS; r17qQ: } private function update() { $oSlide = clone $this; if (!empty($oSlide->thumbnail)) { goto AO299; } unset($oSlide->thumbnail); AO299: unset($oSlide->absoluteImage, $oSlide->absoluteThumbnail, $oSlide->id); return Shop::Container()->getDB()->update("\x78\160\154\x75\147\151\156\x5f\x61\144\x6d\157\162\162\x69\x73\x5f\160\162\x6f\137\x73\154\x69\x64\x65", "\151\144", (int) $this->id, $oSlide); } private function append() { $oSlide = clone $this; unset($oSlide->absoluteImage, $oSlide->absoluteThumbnail, $oSlide->id); if (!($this->sort === null)) { goto CPA7q; } $oSort = Shop::Container()->getDB()->query("\12\40\x20\x20\x20\x20\40\40\40\40\x20\40\40\x20\x20\123\105\114\x45\x43\x54\40\x6e\123\157\x72\164\xa\40\x20\40\x20\40\x20\x20\x20\40\40\x20\40\x20\x20\x20\40\40\x20\106\x52\x4f\x4d\x20\x78\160\x6c\x75\x67\x69\x6e\137\141\144\x6d\x6f\162\x72\x69\163\137\160\162\x6f\137\163\x6c\x69\144\x65\xa\x20\x20\x20\40\x20\x20\x20\40\40\40\x20\x20\x20\40\x20\40\40\40\127\x48\x45\122\105\40\x73\154\x69\144\x65\x72\111\x64\40\x3d\x20" . $this->sliderId . "\xa\40\40\x20\40\40\x20\40\40\40\x20\40\x20\40\x20\40\x20\40\40\x4f\122\x44\x45\122\40\102\x59\x20\x6e\123\x6f\x72\x74\x20\x44\105\x53\103\x20\x4c\111\x4d\111\x54\x20\61", 1); $oSlide->sort = !is_object($oSort) || $oSort->nSort == 0 ? 1 : $oSort->nSort + 1; CPA7q: $id = Shop::Container()->getDB()->insert("\x78\160\x6c\165\x67\x69\156\x5f\x61\x64\x6d\x6f\x72\162\151\x73\x5f\160\x72\157\x5f\x73\154\x69\144\x65", $oSlide); if (!((int) $id > 0)) { goto qQQhI; } $this->id = $id; return true; qQQhI: return false; } public function delete() { if (!($this->id !== null && (int) $this->id > 0)) { goto cBzVx; } $bSuccess = Shop::Container()->getDB()->delete("\170\160\154\165\x67\151\x6e\x5f\x61\x64\x6d\157\x72\162\x69\x73\x5f\x70\x72\x6f\137\x73\154\151\x64\145", "\x69\x64", (int) $this->id); return (int) $bSuccess !== 0; cBzVx: return false; } public function setFallbackValues() { if (!($this->separatorLine && $this->separatorLineLength == "\60" || empty($this->separatorLineLength))) { goto Ts3tL; } $this->separatorLineLength = "\61\60\60\x25"; Ts3tL: } public function getID() : int { return $this->id; } public function setID($id) : void { $this->id = (int) $id; } public function getSliderID() : int { return $this->sliderId; } public function setSliderID($sliderId) : void { $this->sliderId = (int) $sliderId; } public function getTitle() : string { return $this->title; } public function setTitle(string $title) : void { $this->title = $title; } public function getImage() : string { return $this->image; } public function setImage(string $image) : void { $this->image = $image; } public function getText() : string { return $this->text; } public function setText(string $text) : void { $this->text = $text; } public function getContent() : string { return $this->content; } public function setContent(string $text) : void { $this->content = $text; } public function getExtraText() : string { return $this->extraText; } public function setExtraText(string $text) : void { $this->extraText = $text; } public function getAltTag() : string { return $this->altTag; } public function setAltTag(string $text) : void { $this->altTag = $text; } public function getButtonText() : string { return $this->buttonText; } public function setButtonText(string $text) : void { $this->buttonText = $text; } public function getThumbnail() : string { return $this->thumbnail; } public function setThumbnail(string $thumbnail) : void { $this->thumbnail = $thumbnail; } public function getLink() : string { return $this->link; } public function setLink(string $link) : void { $this->link = $link; } public function getSort() : int { return $this->sort; } public function setSort($sort) : void { $this->sort = (int) $sort; } public function getAbsoluteImage() : string { return $this->absoluteImage; } public function setAbsoluteImage(string $absoluteImage) : void { $this->absoluteImage = $absoluteImage; } public function getAbsoluteThumbnail() : string { return $this->absoluteThumbnail; } public function setAbsoluteThumbnail(string $absoluteThumbnail) : void { $this->absoluteThumbnail = $absoluteThumbnail; } }