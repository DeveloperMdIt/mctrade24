<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro; use JTL\Shop; function handleSlider($req, $requestType) { goto uOYoz; q6SZg: vbGmk: $encoded = json_encode($response); header("\x43\x6f\156\x74\145\x6e\164\x2d\164\x79\x70\145\x3a\40\141\x70\160\154\151\143\141\x74\x69\157\156\57\x6a\x73\157\156"); return $encoded; goto p3jeq; Q3ibE: if ($oSlider->save() === true) { goto vVUd8; } $response["\x6d\145\x73\x73\x61\x67\x65"] = "\x65\x72\x72\157\x72\40\167\x68\x65\156\x20\x73\x61\x76\x69\x6e\x67\40\x74\157\40\104\x42"; $response["\x65\x72\162\157\x72"] = true; goto Otv0O; vVUd8: $response["\x64\x61\x74\141"] = $oSlider; $response["\155\x65\163\x73\141\x67\145"] = "\163\x75\x63\x63\x65\x73\163"; Shop::Container()->getDB()->delete("\x74\x65\x78\x74\x65\156\x73\x69\x6f\156\x70\x6f\x69\x6e\164", ["\x63\x43\x6c\x61\x73\x73", "\x6b\x49\x6e\151\164\151\x61\x6c"], ["\120\154\x75\147\151\x6e\134\x61\x64\155\x6f\x72\x72\x69\x73\x5f\x70\x72\x6f\134\101\155\123\154\151\x64\145\x72", $oSlider->id]); $oExtension = new \stdClass(); $oExtension->kSprache = $kSprache; goto aLnvM; uqN9y: $cValue = ''; if ($nSeite === PAGE_ARTIKEL) { goto sxxDD; } if ($nSeite === PAGE_ARTIKELLISTE) { goto PxZHQ; } if ($nSeite === PAGE_EIGENE) { goto UsyeJ; } goto kNThR; sxxDD: $cKey = "\153\101\x72\164\151\x6b\x65\154"; $cKeyValue = "\141\x72\164\151\143\154\145\x5f\x6b\x65\x79"; $cValue = $slider[$cKeyValue]; goto kNThR; goto n6b5g; vExTO: $id = (int) $data["\151\x64"]; $oSlider->load($id); $bSuccess = $oSlider->delete($id); if ($bSuccess) { goto AUG0V; } $response["\155\x65\x73\x73\x61\x67\145"] = "\145\x72\x72\x6f\x72"; goto FV3rq; AUG0V: $response["\x6d\x65\163\x73\141\147\145"] = "\163\x6c\151\x64\145\162\x20\144\145\x6c\145\164\x65\144"; FV3rq: Y83V4: goto q6SZg; airO4: HIz9n: $slider = $data["\163\x6c\151\x64\x65\162"]; $slider["\163\x69\x7a\145\x52\141\164\151\x6f"] = json_encode($slider["\x73\x69\x7a\145\122\x61\x74\151\157"]); $kSprache = (int) $slider["\x6c\141\x6e\147\x75\141\x67\145"]; $kKundengruppe = $slider["\143\165\x73\x74\157\x6d\145\162\x47\162\x6f\165\x70"]; $nSeite = (int) $slider["\160\x61\x67\x65\124\x79\160\145"]; $cKey = $slider["\143\113\x65\x79"] ?? ''; $oSlider->load($slider["\x69\x64"] ?? 0); $oSlider->set($slider); $cKeyValue = ''; goto uqN9y; n6b5g: PxZHQ: $aFilter_arr = ["\x6b\x54\x61\x67" => "\164\x61\x67\137\x6b\x65\x79", "\153\115\x65\162\153\x6d\141\x6c\x57\x65\x72\164" => "\x61\x74\x74\162\151\142\x75\164\145\x5f\153\x65\171", "\153\113\141\x74\145\x67\157\x72\x69\145" => "\x63\141\164\145\x67\x6f\x72\151\145\163\137\x6b\145\x79", "\153\110\x65\162\163\164\145\154\154\x65\162" => "\x6d\141\156\x75\146\141\x63\x74\165\162\x65\162\x5f\153\145\x79", "\x63\x53\x75\143\x68\x65" => "\x6b\145\171\143\123\x75\x63\x68\x65"]; $cKeyValue = $aFilter_arr[$cKey]; $cValue = $slider[$cKeyValue]; goto kNThR; UsyeJ: $cKey = "\153\114\151\156\x6b"; $cKeyValue = "\154\x69\x6e\x6b\x5f\153\x65\x79"; $cValue = $slider[$cKeyValue]; kNThR: goto Q3ibE; uOYoz: $response = []; if (!empty($req) && !empty($requestType)) { goto Ra1DR; } $response["\155\145\163\163\x61\x67\145"] = "\x64\x61\164\141\x20\145\155\160\164\x79"; goto vbGmk; Ra1DR: $data = $req; $oSlider = new AmSlider(); if ($requestType === "\x73\x61\166\x65") { goto HIz9n; } if ($requestType === "\x64\145\154\145\164\x65") { goto dLZwL; } goto Y83V4; goto airO4; aLnvM: $oExtension->kKundengruppe = $kKundengruppe; $oExtension->nSeite = $nSeite; $oExtension->cKey = $cKey; $oExtension->cValue = $cValue; $oExtension->cClass = "\120\x6c\x75\147\151\156\134\x61\x64\155\x6f\162\162\151\163\137\x70\162\157\x5c\x41\x6d\x53\154\151\144\145\162"; $oExtension->kInitial = $oSlider->id; Shop::Container()->getDB()->insert("\164\145\x78\164\145\x6e\163\x69\157\x6e\160\157\x69\156\x74", $oExtension); Otv0O: goto Y83V4; dLZwL: goto vExTO; p3jeq: } function handleGetSlider($req) { require dirname(__FILE__) . "\57\163\x6c\x69\144\x65\162\137\x68\145\154\x70\145\162\x73\x2e\x70\150\160"; $sliders = Shop::Container()->getDB()->query("\123\105\114\x45\x43\x54\x20\52\40\106\x52\117\x4d\x20\170\160\154\x75\147\x69\156\x5f\x61\x64\155\157\x72\x72\151\163\137\160\162\x6f\x5f\163\154\x69\144\x65\x72", 2); $sliders = setSliderTypes($sliders); foreach ($sliders as $slider) { goto J7QCs; lAwqS: $slider->article_key = $extensionPoint->cValue; goto kJqp5; toPHg: $aFilter_arr = ["\153\x54\x61\x67" => "\x74\141\x67\x5f\153\x65\x79", "\x6b\115\145\x72\153\x6d\141\x6c\127\x65\162\164" => "\x61\x74\x74\162\151\142\x75\164\145\137\x6b\x65\x79", "\153\113\x61\x74\145\147\x6f\x72\151\145" => "\143\141\164\x65\147\157\162\151\x65\163\x5f\153\x65\171", "\x6b\110\145\162\163\164\145\154\154\x65\x72" => "\x6d\x61\156\x75\x66\x61\x63\164\x75\x72\x65\x72\x5f\x6b\x65\x79", "\x63\x53\x75\143\x68\x65" => "\x6b\x65\171\143\x53\165\143\x68\x65"]; if (empty($extensionPoint->cKey)) { goto OI1LO; } $slider->cKey = $extensionPoint->cKey; $cKeyValue = $aFilter_arr[$extensionPoint->cKey]; $slider->{$cKeyValue} = $extensionPoint->cValue; OI1LO: goto kJqp5; goto RcOFV; RcOFV: TccVD: $cKeyValue = "\x6c\x69\x6e\x6b\x5f\153\145\x79"; $slider->{$cKeyValue} = $extensionPoint->cValue; kJqp5: EkP1F: Am4s6: goto a328z; J7QCs: $extensionPoint = Shop::Container()->getDB()->select("\164\145\170\x74\x65\x6e\x73\x69\157\x6e\160\157\x69\156\x74", "\143\x43\154\x61\x73\x73", "\120\154\x75\x67\x69\x6e\134\141\144\155\x6f\x72\x72\151\163\137\160\162\157\x5c\x41\x6d\x53\x6c\151\x64\x65\162", "\153\111\x6e\151\164\x69\141\154", (int) $slider->id); if (empty($extensionPoint)) { goto EkP1F; } $slider->language = (int) $extensionPoint->kSprache; $slider->customerGroup = (int) $extensionPoint->kKundengruppe; $slider->pageType = (int) $extensionPoint->nSeite; if ($slider->pageType == PAGE_ARTIKEL) { goto rmCs7; } if ($slider->pageType == PAGE_ARTIKELLISTE) { goto toPHg; } if ($slider->pageType === PAGE_EIGENE) { goto TccVD; } goto kJqp5; rmCs7: goto lAwqS; a328z: } uJdYX: $response["\144\141\x74\141"] = $sliders; $encoded = json_encode($response); header("\103\157\x6e\164\x65\156\x74\x2d\x74\x79\x70\x65\x3a\40\x61\160\160\154\151\x63\x61\x74\151\x6f\156\x2f\152\163\157\156"); return $encoded; } function handleSliderCopy($req) { $response = []; $sliderId = (int) $req["\151\144"]; $oSlider = new AmSlider(); $oSlider->load($sliderId); $oSlider->id = null; if ($oSlider->save()) { goto WpzqP; } $response["\x65\162\162\x6f\x72"] = true; goto hHoXv; WpzqP: $newSliderId = $oSlider->id; $slides = Shop::Container()->getDB()->selectAll("\170\x70\x6c\165\x67\x69\x6e\x5f\x61\144\155\x6f\162\162\151\x73\x5f\160\x72\x6f\137\163\x6c\151\144\145", "\163\154\151\144\145\162\x49\144", $sliderId); foreach ($slides as $slide) { $oSlide = new \Plugin\admorris_pro\AmSlide(); foreach ($slide as $property => $value) { $oSlide->{$property} = $value; sjvHP: } VkyYz: $oSlide->id = null; $oSlide->sliderId = $newSliderId; $oSlide->save(); gd0JI: } ysZGd: $oSlider->flushSliderCache(); $response["\x64\x61\x74\141"] = $oSlider; $response["\145\162\x72\x6f\162"] = false; hHoXv: $encoded = json_encode($response); header("\103\x6f\156\x74\145\156\164\x2d\164\171\160\x65\72\x20\x61\x70\160\x6c\151\143\141\x74\x69\157\156\57\152\163\x6f\x6e"); return $encoded; } function getSlides($req) { require dirname(__FILE__) . "\x2f\x73\154\x69\144\145\x72\x5f\150\x65\x6c\160\x65\x72\x73\56\x70\x68\x70"; $sliderId = (int) $req["\x69\144"]; $oSlider = new AmSlider(); $oSlider->load($sliderId); $response["\x64\x61\164\x61"] = setSlideTypes($oSlider->slide_arr, true); $encoded = json_encode($response); return $encoded; } function saveSlides($req) { require dirname(__FILE__) . "\x2f\163\x6c\151\144\x65\x72\x5f\x68\x65\154\x70\145\x72\x73\x2e\160\150\160"; $sliderId = (int) $req["\x73\154\151\x64\145\162\111\x64"]; $response = []; if (!$sliderId) { goto QQGqb; } $bSuccess = Shop::Container()->getDB()->delete("\170\x70\x6c\x75\147\151\x6e\137\x61\x64\155\x6f\162\x72\151\163\x5f\160\x72\x6f\137\x73\154\x69\144\x65", "\x73\x6c\x69\x64\145\162\x49\x64", $sliderId); QQGqb: if (isset($req["\x73\x6c\x69\144\145\104\x61\x74\x61"])) { goto BaHuf; } $response["\155\x65\x73\x73\141\x67\x65"] = "\x53\154\151\x64\x65\x73\x20\x64\145\x6c\x65\x74\x65\x64"; goto xRCuM; BaHuf: $response["\x6d\x65\x73\163\141\x67\145"] = ''; $response["\x73\154\x69\x64\x65\x73"] = []; foreach ($req["\x73\x6c\x69\x64\x65\x44\141\164\141"] as $key => $value) { $oSlide = new AmSlide(); $cObjectFields_arr = get_class_vars("\120\x6c\165\x67\151\156\134\141\144\155\157\162\162\151\163\x5f\x70\x72\x6f\x5c\x41\155\123\x6c\x69\144\x65"); foreach ($cObjectFields_arr as $cField => $cValue) { if (!isset($value[$cField])) { goto Vyflz; } $oSlide->{$cField} = $value[$cField]; Vyflz: R7GTL: } NYBFy: $oSlide->sliderId = $sliderId; setSlideTypes($oSlide, false); unset($oSlide->id); $success = $oSlide->save(); $response["\145\x72\162\x6f\162"] = !$success; array_push($response["\163\x6c\151\144\145\x73"], $oSlide); q3MOD: } hykLk: $cache = Shop::Container()->getCache(); $cache->flushTags([AmSlider::CACHE_TAG_SLIDERS]); xRCuM: $encoded = json_encode($response); header("\103\157\156\164\x65\x6e\164\x2d\164\x79\x70\145\72\x20\141\x70\160\154\151\x63\141\164\x69\157\156\57\x6a\x73\x6f\x6e"); return $encoded; }