<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\Migrations; use JTL\Plugin\Migration; use JTL\Update\IMigration; use JTL\Shop; use JTL\Language\LanguageHelper; use Plugin\admorris_pro\ioHandling\cookieNoticePro\{CookieNoticeProCookies, CookieNoticeProSettings, CookieNoticeProScripts, CookieNoticeProTriggerFilters, CookieNoticeProDescriptions}; use Plugin\admorris_pro\ConsentManagerIntegration; use Plugin\admorris_pro\GoogleCustomerReviews; use Plugin\admorris_pro\LiveChat; use Plugin\admorris_pro\pluginSettings\PluginSettingsNew; use Plugin\admorris_pro\ShopVote; use stdClass; require_once __DIR__ . "\x2f\56\x2e\57\142\x75\151\154\x64\x2f\x76\x65\156\144\157\162\x2f\163\143\157\x70\x65\162\x2d\x61\165\x74\x6f\154\x6f\141\x64\56\160\150\x70"; class Migration20220131010100 extends Migration implements IMigration { protected $description = "\x63\x6f\157\x6b\x69\x65\x5f\x6e\157\164\151\143\145\x5f\160\x72\x6f\40\162\145\x66\141\x63\164\x6f\x72"; public function up() { goto Z4LIN; d_qgx: if (!(!empty($currentLiveChatSetting) && $currentLiveChatSetting->cWert === "\131")) { goto qyG5N; } LiveChat::registerConsent(); qyG5N: $currentGoogleCustomerReviewsSetting = PluginSettingsNew::where("\143\x4e\141\155\x65", "\141\144\155\157\x72\x72\151\x73\137\x70\x72\157\x5f\155\x61\x72\153\x65\x74\x69\156\147\137\164\162\x75\163\164\x6d\x61\x72\153\137\x67\157\157\147\154\145\x5f\x61\143\164\151\166\x65", true); if (!(!empty($currentGoogleCustomerReviewsSetting) && $currentGoogleCustomerReviewsSetting->cWert === "\131")) { goto k2tST; } GoogleCustomerReviews::registerConsent(); k2tST: $currentShopVoteSetting = PluginSettingsNew::where("\x63\x4e\141\155\145", "\141\x64\155\157\x72\162\x69\163\x5f\x70\162\x6f\137\x6d\x61\x72\153\x65\164\151\x6e\x67\x5f\x74\162\x75\163\164\x6d\x61\x72\x6b\x5f\x67\x6f\x6f\147\154\145\x5f\141\x63\x74\x69\x76\145", true); if (!(!empty($currentShopVoteSetting) && $currentShopVoteSetting->cWert === "\x59")) { goto gNtBR; } ShopVote::registerConsent(); goto L1MmV; fpMJq: r9AOL: $this->execute("\101\114\x54\x45\122\x20\x54\101\102\114\105\40\170\x70\x6c\x75\147\x69\x6e\x5f\141\x64\155\157\162\162\x69\163\x5f\160\162\x6f\137\x63\x6f\x6f\153\x69\145\137\x6e\x6f\164\x69\143\x65\137\x70\162\157\137\144\x65\163\x63\x72\x69\160\x74\x69\x6f\x6e\40\101\104\104\40\x63\x6f\x6f\153\151\x65\x50\x75\x72\x70\x6f\x73\145\x20\x76\141\162\x63\x68\x61\x72\50\62\65\x35\x29\x20\x44\x45\106\x41\125\x4c\124\40\47\47"); $cookieNotices = CookieNoticeProCookies::getAll(); function findCookieNoticePurposeById($id, $arr) { $found = false; foreach ($arr as $item) { if (!($item->id === $id)) { goto R3lG2; } $found = $item->cookiePurpose; R3lG2: wiVcN: } SwRoO: return $found; } $newObj = new stdClass(); $purpose = null; foreach ($descriptions as $descItem) { $purpose = findCookieNoticePurposeById($descItem->cookieId, $cookieNotices); if (!$purpose) { goto bOalr; } $newObj = $descItem; $newObj->cookiePurpose = $purpose; CookieNoticeProDescriptions::update($newObj); bOalr: B2dEE: } FuDl2: $this->execute("\101\x4c\x54\x45\122\x20\x54\x41\x42\x4c\x45\40\x78\160\x6c\165\147\x69\156\137\141\144\x6d\157\x72\162\151\x73\x5f\x70\x72\x6f\137\x63\157\157\x6b\151\x65\x5f\156\x6f\x74\151\143\145\x5f\x70\162\x6f\x20\104\122\x4f\x50\x20\143\x6f\x6f\153\151\x65\x50\165\162\160\157\163\x65"); $this->execute("\x43\122\x45\101\x54\105\40\x54\x41\102\x4c\105\x20\111\x46\40\116\117\124\x20\x45\130\111\123\124\x53\40\x78\160\154\x75\147\151\156\x5f\141\x64\x6d\x6f\162\162\x69\163\x5f\x70\162\157\137\143\157\157\153\x69\x65\137\x6e\157\x74\151\x63\x65\x5f\x70\x72\157\137\x73\143\162\151\x70\164\x73\x20\x28\xa\40\40\x20\40\x20\40\x69\x64\x20\x49\x4e\x54\x28\61\60\x29\40\116\117\x54\x20\116\125\114\114\x20\x41\x55\x54\117\137\111\x4e\x43\122\x45\x4d\x45\116\124\40\x4e\117\x54\40\x4e\x55\114\114\x20\120\x52\x49\x4d\101\x52\x59\x20\x4b\105\x59\54\12\40\x20\40\40\40\x20\143\x6f\x6f\153\151\145\111\144\x20\x49\116\124\x28\61\x30\51\40\x55\116\123\111\107\x4e\105\104\54\12\40\40\x20\40\x20\x20\x46\117\x52\x45\x49\107\x4e\40\x4b\105\x59\x20\50\x63\157\x6f\153\x69\x65\x49\x64\51\40\122\105\106\x45\x52\105\x4e\x43\x45\x53\40\170\x70\154\165\147\x69\156\x5f\x61\x64\155\157\162\x72\x69\x73\137\160\162\157\137\x63\x6f\157\153\x69\x65\x5f\x6e\x6f\x74\151\x63\145\x5f\x70\x72\157\x28\151\x64\51\54\xa\40\40\x20\x20\40\x20\x73\143\x72\x69\160\164\40\124\x45\x58\x54\54\12\40\x20\x20\40\40\x20\163\143\x72\x69\x70\164\x4e\141\x6d\145\40\x56\x41\122\103\110\x41\x52\50\x32\x35\x35\x29\54\12\40\x20\x20\x20\x20\x20\164\x72\x69\147\x67\145\162\x46\151\x6c\x74\x65\x72\117\160\x65\x72\x61\x74\157\162\x20\145\156\165\x6d\x28\x27\141\156\144\x27\x2c\47\157\x72\x27\51\40\116\117\124\40\x4e\125\114\x4c\12\x20\40\x20\x20\x20\x20\51\40\105\x4e\x47\x49\x4e\105\75\111\x6e\156\157\104\102\x20\103\110\x41\x52\x53\x45\124\x3d\x75\164\x66\x38\40\103\x4f\114\x4c\x41\x54\105\x3d\x75\x74\146\70\137\x75\x6e\x69\143\x6f\x64\145\137\x63\151\x3b"); goto mL_ZH; L1MmV: gNtBR: $this->execute("\x43\x52\x45\x41\124\x45\x20\124\101\102\x4c\x45\40\111\106\40\x4e\x4f\x54\x20\105\130\111\123\x54\123\40\x78\160\x6c\x75\147\x69\x6e\x5f\x61\144\x6d\x6f\162\x72\151\x73\x5f\160\162\x6f\137\143\157\157\153\151\145\137\x6e\x6f\164\x69\143\x65\137\160\x72\157\137\163\145\164\x74\x69\x6e\x67\163\40\x28\12\40\x20\x20\x20\x20\40\x69\x64\40\111\x4e\x54\50\61\x30\51\x20\x4e\117\124\x20\116\x55\x4c\x4c\x20\101\x55\124\x4f\137\111\x4e\x43\x52\105\115\x45\116\x54\x20\x4e\117\124\40\x4e\x55\x4c\114\40\120\122\x49\115\x41\x52\x59\40\x4b\x45\x59\54\12\40\x20\40\x20\x20\40\x73\x65\x74\164\x69\156\147\x4e\141\x6d\x65\40\x56\x41\x52\103\110\101\122\40\50\x32\x35\65\51\40\116\x4f\124\40\116\125\114\x4c\54\xa\40\x20\40\40\40\40\163\x65\x74\x74\151\156\x67\x56\x61\154\165\145\x20\x56\101\x52\103\110\x41\122\40\x28\62\x35\x35\x29\x20\116\x4f\x54\x20\116\125\114\x4c\12\x20\40\x20\x20\x20\40\51\40\105\116\x47\111\x4e\x45\x3d\x49\x6e\156\157\x44\102\40\x43\x48\x41\122\123\x45\124\x3d\x75\x74\x66\70\x20\103\117\x4c\x4c\101\124\105\x3d\165\x74\146\70\137\165\156\151\x63\157\144\145\x5f\x63\x69\x3b"); $templateThemeSettings = Shop::Container()->getDB()->selectAll("\x78\x70\x6c\165\x67\151\x6e\x5f\141\144\x6d\157\x72\162\151\163\137\160\162\x6f\137\x74\x68\145\155\x65", [], []); if (empty($templateThemeSettings)) { goto JoghK; } $templateThemeSettings = json_decode($templateThemeSettings[0]->data); JoghK: $settingsFields = [["\163\x65\x74\164\151\x6e\x67\116\141\155\145" => "\x70\x6f\x73\151\164\151\x6f\x6e", "\163\x65\164\164\151\x6e\147\126\x61\154\165\x65" => "\x62\157\x74\x74\157\155\x2d\x63\145\156\164\145\162"], ["\163\145\x74\164\151\156\x67\x4e\141\155\x65" => "\x70\x6f\x73\x69\164\x69\157\x6e\x4d\x6f\144\x61\154", "\163\x65\164\164\x69\156\x67\x56\x61\154\165\145" => "\x63\x65\x6e\x74\145\x72"], ["\163\145\164\164\x69\x6e\147\x4e\x61\155\x65" => "\x75\x73\145\124\150\145\x6d\x65", "\163\x65\164\x74\151\156\x67\x56\x61\x6c\x75\145" => "\x31"], ["\x73\x65\x74\164\x69\x6e\147\116\141\155\x65" => "\x62\x75\x74\164\x6f\156\x43\x6f\x6c\x6f\x72", "\163\145\x74\164\x69\156\147\126\141\154\165\145" => !empty($templateThemeSettings) ? $templateThemeSettings->btnPrimaryBg : ''], ["\x73\x65\164\x74\x69\x6e\x67\x4e\141\x6d\x65" => "\142\x75\x74\x74\x6f\x6e\124\x65\x78\164\x43\x6f\x6c\x6f\x72", "\163\145\164\x74\x69\x6e\x67\x56\141\x6c\165\145" => !empty($templateThemeSettings) ? $templateThemeSettings->btnPrimaryColor : ''], ["\x73\145\x74\x74\x69\x6e\x67\x4e\x61\155\145" => "\154\x69\x6e\153\103\157\x6c\157\162", "\x73\x65\164\164\x69\156\x67\x56\x61\x6c\165\145" => !empty($templateThemeSettings) ? $templateThemeSettings->linkColor : ''], ["\x73\x65\164\x74\x69\x6e\147\116\x61\x6d\x65" => "\x68\x65\141\x64\x6c\x69\156\x65\163\103\x6f\154\x6f\x72", "\x73\x65\x74\164\x69\x6e\147\126\x61\154\x75\145" => !empty($templateThemeSettings) ? $templateThemeSettings->headingsColor : ''], ["\x73\145\164\x74\x69\x6e\x67\x4e\141\155\145" => "\164\145\170\164\x43\157\x6c\157\x72", "\163\x65\x74\x74\x69\x6e\147\x56\141\x6c\165\x65" => !empty($templateThemeSettings) ? $templateThemeSettings->textColor : ''], ["\x73\145\x74\x74\151\x6e\147\116\x61\x6d\145" => "\x62\141\x63\x6b\147\x72\157\165\x6e\x64\x43\157\x6c\x6f\x72", "\x73\145\x74\164\151\156\x67\x56\141\x6c\x75\x65" => !empty($templateThemeSettings) ? $templateThemeSettings->bodyBg : '']]; foreach ($settingsFields as $field) { CookieNoticeProSettings::create((object) $field); T3BuF: } DwKF9: $pluginSettingsToDelete = ["\141\144\x6d\x6f\162\162\151\x73\137\160\x72\157\x5f\x6d\141\x72\x6b\145\x74\x69\156\x67\137\143\157\x6f\x6b\151\x65\x5f\x6e\x6f\164\151\143\145\x5f\x70\162\157\137\142\x74\x6e\x5f\x62\x67\x63\x6f\x6c\157\162", "\141\144\155\x6f\162\x72\x69\163\x5f\x70\x72\157\x5f\x6d\x61\162\x6b\x65\164\x69\156\x67\x5f\x63\x6f\157\x6b\x69\145\137\x6e\x6f\x74\x69\143\145\137\160\x72\157\137\142\x74\156\x5f\164\x78\164\x5f\x63\157\x6c\157\162", "\141\144\x6d\x6f\x72\162\x69\x73\137\160\x72\x6f\137\155\141\x72\x6b\145\x74\151\x6e\147\x5f\143\157\157\x6b\151\x65\137\156\x6f\x74\151\x63\145\137\160\x72\157\137\142\x67\x63\157\x6c\157\162", "\141\x64\x6d\157\x72\x72\x69\163\137\x70\x72\x6f\x5f\x6d\141\x72\153\145\x74\x69\x6e\147\x5f\143\x6f\157\x6b\x69\x65\137\156\x6f\x74\151\x63\145\x5f\x70\x72\x6f\137\164\x78\164\x5f\x63\x6f\x6c\157\162", "\141\x64\155\x6f\x72\x72\151\x73\x5f\160\162\157\137\x6d\x61\x72\x6b\145\x74\x69\x6e\x67\x5f\x63\x6f\x6f\153\151\145\137\x6e\157\x74\x69\143\145\137\160\x72\157\x5f\x65\x78\160\151\x72\141\x74\151\x6f\156", "\141\144\x6d\x6f\162\x72\x69\x73\x5f\x70\x72\x6f\x5f\x6d\141\162\x6b\145\x74\x69\x6e\147\x5f\143\x6f\157\153\151\x65\137\156\157\164\x69\143\x65\x5f\160\162\x6f\137\160\x6f\163\x69\x74\151\x6f\156", "\141\x64\155\157\162\x72\151\x73\x5f\160\x72\x6f\x5f\155\141\162\153\x65\164\x69\156\x67\x5f\x63\157\157\153\x69\145\x5f\x6e\x6f\x74\151\x63\145\x5f\x70\x72\x6f\x5f\x70\157\x73\x69\x74\151\x6f\x6e\137\x73\145\164\164\151\156\x67\163", "\x61\144\155\x6f\162\162\151\163\x5f\160\x72\x6f\x5f\155\141\162\153\145\x74\x69\156\x67\x5f\x63\x6f\157\153\151\145\x5f\156\x6f\x74\151\x63\145\x5f\160\x72\x6f\137\x6c\151\156\153", "\141\144\x6d\157\x72\162\151\163\x5f\160\x72\x6f\x5f\x6d\x61\x72\x6b\x65\x74\151\156\x67\x5f\x63\157\x6f\x6b\151\x65\x5f\x6e\157\164\151\x63\x65\x5f\160\x72\157\x5f\x6d\x75\x73\x74\x5f\x63\x6f\x6e\163\145\156\164"]; goto OJrgD; mL_ZH: $this->execute("\103\122\x45\x41\124\105\40\124\x41\x42\114\105\40\x49\x46\x20\116\x4f\124\x20\105\x58\111\123\124\x53\x20\170\160\154\x75\147\x69\156\137\x61\144\x6d\157\x72\162\x69\163\137\x70\x72\x6f\137\x63\x6f\157\x6b\x69\x65\x5f\x6e\157\x74\x69\143\145\137\160\162\157\x5f\164\162\x69\x67\147\145\x72\137\x66\x69\x6c\x74\x65\162\x73\x20\50\xa\x20\40\x20\x20\40\x20\x69\x64\40\111\116\x54\50\61\60\x29\x20\x4e\x4f\x54\x20\x4e\125\x4c\x4c\x20\x41\125\124\x4f\137\111\x4e\103\122\105\x4d\105\x4e\124\x20\116\117\x54\40\x4e\125\114\x4c\40\120\x52\111\x4d\x41\122\x59\x20\113\x45\x59\x2c\12\x20\x20\x20\x20\x20\40\163\143\162\151\x70\164\111\x64\x20\111\x4e\x54\50\x31\60\x29\54\xa\40\x20\x20\x20\x20\x20\x46\117\x52\105\x49\x47\x4e\40\x4b\105\x59\40\x28\163\x63\162\151\160\x74\111\144\51\x20\122\105\x46\x45\x52\x45\116\103\105\123\40\170\x70\x6c\165\x67\151\156\x5f\x61\144\x6d\157\162\x72\x69\x73\137\x70\162\x6f\137\143\157\157\x6b\x69\x65\137\156\x6f\x74\x69\x63\x65\x5f\160\162\x6f\137\x73\143\162\151\160\164\x73\x28\x69\x64\x29\54\12\x20\x20\40\40\x20\40\164\x72\151\147\x67\x65\162\x46\151\154\164\145\x72\x54\171\x70\145\x20\126\101\122\x43\110\101\x52\40\50\x32\x35\x35\x29\x20\x4e\x4f\x54\40\x4e\x55\114\114\x2c\xa\40\40\x20\40\x20\40\164\162\x69\x67\x67\145\x72\106\x69\x6c\164\x65\x72\126\x61\154\x75\x65\40\126\101\x52\103\x48\x41\122\x20\50\62\x35\x35\x29\x20\116\x4f\124\x20\x4e\x55\114\x4c\xa\40\x20\x20\x20\40\40\51\x20\x45\116\x47\111\116\x45\75\111\x6e\x6e\x6f\104\102\x20\103\110\101\x52\123\x45\x54\x3d\165\x74\146\70\x20\x43\117\114\x4c\x41\x54\x45\x3d\x75\164\x66\x38\137\165\x6e\x69\143\x6f\144\145\137\x63\151\x3b"); foreach ($cookieNotices as $cookie) { goto Rai91; Rai91: if (!(isset($cookie->scriptAll) && $cookie->scriptAll !== '')) { goto lEKk3; } $newObj = new stdClass(); $newObj->cookieId = $cookie->id; $newObj->script = $cookie->scriptAll; $newObj->scriptName = "\x53\x63\x72\x69\x70\x74\40\55\x20\141\x6c\x6c\x65\40\123\x65\151\164\145\156"; $newObj->triggerFilterOperator = "\141\156\x64"; CookieNoticeProScripts::create($newObj); lEKk3: if (!(isset($cookie->scriptConfirmation) && $cookie->scriptConfirmation !== '')) { goto UxgDY; } $newObj = new stdClass(); goto sjJaM; sjJaM: $newObj->cookieId = $cookie->id; $newObj->script = $cookie->scriptConfirmation; $newObj->scriptName = "\123\143\162\151\x70\164\x20\x2d\40\102\x65\x73\x74\x65\x6c\x6c\142\x65\163\164\303\xa4\164\x69\147\x75\x6e\x67"; $newObj->triggerFilterOperator = "\141\156\144"; $newScript = CookieNoticeProScripts::create($newObj); $newTriggerFilter = new stdClass(); $newTriggerFilter->scriptId = $newScript->id; $newTriggerFilter->triggerFilterType = "\x70\141\x67\145\124\x79\160\x65"; $newTriggerFilter->triggerFilterValue = "\63\63"; CookieNoticeProTriggerFilters::create($newTriggerFilter); goto cWRMm; cWRMm: UxgDY: HWtIA: goto lryLw; lryLw: } ZJjsB: $this->execute("\101\114\x54\x45\122\40\x54\x41\102\x4c\105\x20\170\160\x6c\x75\x67\x69\x6e\x5f\141\x64\155\x6f\x72\162\x69\163\137\x70\x72\x6f\137\143\157\x6f\x6b\x69\x65\137\156\157\164\151\x63\x65\x5f\160\162\x6f\40\104\122\117\x50\40\163\x63\x72\151\160\x74\x41\154\154"); $this->execute("\x41\114\x54\x45\x52\40\x54\x41\102\x4c\x45\x20\170\160\x6c\165\147\151\x6e\x5f\x61\x64\155\x6f\162\162\151\163\x5f\160\162\157\137\143\x6f\x6f\x6b\x69\145\x5f\156\x6f\x74\151\x63\x65\x5f\x70\162\x6f\x20\104\122\117\x50\x20\163\x63\162\151\x70\x74\103\x6f\156\x66\x69\x72\x6d\x61\x74\x69\157\156"); $allCookies = CookieNoticeProCookies::getAll(); $allLocalizations = CookieNoticeProDescriptions::getAll(); foreach ($allCookies as $cookie) { if (!(!isset($cookie->consentId) && $cookie->active === "\x31")) { goto GLgA8; } $currentCookielocalization = array_filter($allLocalizations, function ($localization) use($cookie) { if (!($localization->cookieId === $cookie->id)) { goto J45QE; } return true; J45QE: }); $payload = ConsentManagerIntegration::createConsentManagerPayload($cookie, $currentCookielocalization); $jtlConsent = ConsentManagerIntegration::registerConsentItem($payload); $obj_merged = ConsentManagerIntegration::mergeAdmCookieAndJTLConsent($cookie, $jtlConsent); CookieNoticeProCookies::update($obj_merged); GLgA8: t2cyL: } AsDlx: $currentLiveChatSetting = PluginSettingsNew::where("\x63\x4e\x61\155\145", "\x61\144\155\157\x72\x72\x69\x73\x5f\x70\162\157\x5f\x6d\x61\162\x6b\145\164\151\x6e\147\137\x6c\x69\166\145\137\143\x68\x61\x74\137\141\x63\x74\x69\166\x65", true); goto d_qgx; Z4LIN: $log = Shop::Container()->getLogService(); $this->execute("\101\x4c\124\x45\x52\x20\x54\x41\x42\x4c\105\40\170\x70\154\165\147\x69\156\137\141\144\x6d\157\162\162\x69\x73\137\160\162\157\x5f\x63\157\x6f\153\151\x65\137\156\157\x74\151\x63\x65\137\x70\162\x6f\40\x41\104\x44\x20\x74\143\157\156\x73\x65\156\164\x49\x64\40\x69\156\x74\50\61\x31\x29"); $this->execute("\101\114\x54\x45\122\40\x54\101\x42\x4c\105\x20\x78\x70\x6c\x75\147\x69\x6e\137\x61\x64\x6d\157\162\x72\x69\163\x5f\160\162\x6f\137\x63\157\157\x6b\x69\x65\x5f\x6e\x6f\x74\151\x63\x65\137\160\162\x6f\40\x41\104\x44\40\150\151\x64\x64\x65\156\116\x61\x6d\x65\x20\166\141\162\143\x68\x61\162\50\x32\x35\65\x29"); $this->execute("\x41\114\124\105\x52\40\124\101\102\x4c\x45\40\170\x70\154\x75\x67\x69\156\137\x61\144\155\157\x72\162\x69\x73\137\160\162\157\x5f\143\157\157\x6b\x69\145\137\156\157\x74\x69\143\x65\137\x70\162\157\40\101\104\104\x20\x63\157\155\160\141\x6e\171\40\166\x61\x72\143\x68\141\x72\50\x32\x35\65\51\x20\x44\105\x46\x41\x55\114\124\x20\x27\47"); $this->execute("\x41\114\124\105\122\x20\x54\x41\102\114\x45\x20\x78\160\x6c\165\147\x69\156\137\x61\144\155\x6f\x72\x72\x69\x73\x5f\x70\162\157\137\143\157\x6f\153\151\x65\x5f\156\157\x74\x69\x63\x65\137\160\x72\x6f\x20\104\x52\117\x50\40\143\157\x6f\153\151\x65\104\145\x66\x61\165\x6c\164"); $this->execute("\x41\114\124\x45\122\x20\124\x41\102\x4c\x45\x20\x78\x70\154\x75\x67\x69\x6e\x5f\141\x64\155\x6f\x72\162\x69\x73\137\160\162\x6f\x5f\143\157\157\x6b\151\145\x5f\156\x6f\x74\x69\143\x65\137\x70\162\157\x20\104\122\x4f\x50\40\143\x6f\157\x6b\x69\145\x52\145\x71\x75\151\x72\145\x64"); $this->execute("\x41\114\x54\x45\x52\40\x54\101\x42\114\x45\40\170\x70\x6c\x75\147\151\x6e\137\x61\x64\x6d\157\162\x72\151\x73\x5f\x70\162\157\x5f\143\x6f\157\x6b\x69\145\x5f\x6e\x6f\164\151\143\x65\137\x70\162\157\x20\x44\x52\117\x50\x20\143\157\157\x6b\151\x65\117\x70\164\x4f\x75\x74"); $this->execute("\x41\x4c\124\105\122\x20\124\x41\x42\x4c\105\x20\170\x70\154\165\147\x69\x6e\137\x61\x64\155\x6f\x72\x72\x69\x73\x5f\160\x72\x6f\x5f\143\x6f\x6f\x6b\x69\145\x5f\156\x6f\x74\x69\x63\145\x5f\160\x72\x6f\40\104\x52\x4f\x50\x20\x63\x6f\x6f\x6b\151\145\117\156\154\171\117\x6e\x63\145"); $this->execute("\101\114\124\x45\122\x20\x54\x41\x42\x4c\105\x20\x78\160\154\x75\x67\x69\x6e\137\141\x64\x6d\157\162\162\151\163\137\x70\162\x6f\137\x63\157\157\153\x69\x65\x5f\156\157\164\x69\x63\x65\137\x70\x72\157\40\104\x52\117\x50\40\163\143\162\x69\x70\x74\x41\x6c\154\120\157\x73\151\x74\x69\157\x6e"); $this->execute("\x41\x4c\124\105\x52\40\124\x41\102\x4c\105\40\x78\x70\x6c\165\147\x69\x6e\x5f\141\144\155\157\x72\x72\151\163\137\x70\x72\157\137\143\x6f\x6f\x6b\151\145\137\x6e\157\x74\151\x63\x65\x5f\x70\x72\x6f\x20\x44\x52\117\120\40\x73\x63\162\x69\160\164\x43\157\x6e\146\x69\x72\155\141\x74\x69\157\x6e\x50\x6f\163\151\x74\x69\157\x6e"); goto R2o7E; R2o7E: $this->execute("\x41\x4c\x54\x45\x52\x20\124\101\x42\114\105\x20\x78\160\x6c\165\147\x69\x6e\137\x61\144\155\157\162\162\151\163\x5f\x70\x72\x6f\137\143\157\x6f\153\151\145\x5f\x6e\157\164\151\x63\145\x5f\160\162\x6f\x5f\x64\x65\x73\x63\x72\x69\160\x74\151\157\x6e\x20\x41\x44\104\x20\x70\162\151\x76\x61\143\171\120\157\x6c\151\143\171\x20\166\x61\162\x63\150\141\x72\x28\x32\65\x35\51\x20\x44\105\106\x41\x55\x4c\124\40\x27\47"); $languages = LanguageHelper::getInstance()->getLangArray(); $iso = []; foreach ($languages as $language) { array_push($iso, LanguageHelper::getInstance()->getIsoFromLangID($language->kSprache)->cISO); orctI: } vlNQy: $descriptions = CookieNoticeProDescriptions::getAll(); $toRemove = []; foreach ($descriptions as $description) { if (in_array($description->languageId, $iso)) { goto rnQJs; } array_push($toRemove, $description); rnQJs: Jl_bX: } k_5Fw: foreach ($toRemove as $descItem) { CookieNoticeProDescriptions::delete($descItem); xb207: } goto fpMJq; OJrgD: foreach ($pluginSettingsToDelete as $field) { Shop::Container()->getDB()->queryPrepared("\104\105\x4c\105\124\x45\40\x46\x52\117\x4d\x20\164\160\154\165\147\x69\156\145\151\x6e\x73\x74\x65\154\154\165\156\147\145\156\40\x57\x48\x45\x52\x45\40\143\116\141\155\145\40\75\x20\72\143\116\x61\155\145", ["\x63\x4e\x61\x6d\x65" => $field], 4); xd9wr: } D2_eh: $log->notice("\x61\x64\155\x6f\162\x72\x69\x73\40\x50\x72\x6f\x20\55\x20\x4d\x69\147\x72\x61\164\151\x6f\x6e\x20\115\151\x67\162\x61\x74\151\x6f\x6e\62\x30\62\62\x30\x31\x33\61\x30\x31\x30\x31\x30\60\40\x4f\113"); goto wZNNz; wZNNz: } public function down() { goto jpFAb; npf_W: $this->execute("\x41\x4c\124\105\x52\x20\x54\101\102\114\x45\40\170\x70\154\165\147\x69\156\137\141\x64\155\x6f\x72\x72\151\x73\x5f\160\x72\157\x5f\143\x6f\157\x6b\x69\145\x5f\156\x6f\x74\151\143\x65\137\160\x72\x6f\x20\101\104\104\x20\x63\x6f\157\153\x69\x65\x52\x65\161\x75\x69\162\145\144\40\x54\x49\116\x59\111\116\x54\x20\x44\x45\106\101\x55\x4c\x54\40\60"); $this->execute("\x41\x4c\124\105\x52\40\124\x41\102\x4c\105\x20\x78\160\x6c\165\147\x69\x6e\x5f\x61\144\155\157\162\x72\151\163\137\160\162\x6f\137\143\x6f\x6f\153\151\x65\137\156\157\164\x69\x63\145\137\x70\162\157\40\x41\104\104\x20\x63\157\x6f\x6b\151\x65\x4f\160\164\x4f\x75\164\x20\124\x49\116\x59\111\116\124\x20\x44\105\x46\101\x55\x4c\x54\x20\x30"); $this->execute("\x41\x4c\x54\x45\x52\x20\x54\101\x42\x4c\105\40\170\160\154\x75\x67\151\156\137\x61\144\155\157\x72\x72\x69\163\137\160\162\x6f\x5f\143\157\x6f\x6b\151\145\x5f\156\x6f\x74\x69\x63\x65\x5f\160\162\157\40\x41\104\x44\x20\143\x6f\157\153\151\x65\117\156\x6c\171\117\x6e\x63\x65\40\x54\x49\116\131\111\x4e\x54\40\104\105\x46\101\x55\114\124\x20\x31"); $this->execute("\101\x4c\124\105\122\40\x54\x41\102\x4c\105\x20\170\x70\x6c\165\147\151\156\137\x61\144\155\x6f\x72\162\151\163\137\160\x72\157\137\x63\157\x6f\153\151\145\137\156\157\x74\x69\x63\145\x5f\x70\x72\x6f\x20\x41\x44\104\40\x73\143\x72\151\160\164\x41\154\x6c\x50\x6f\x73\151\x74\x69\157\x6e\40\126\101\122\103\110\101\x52\x28\x32\x35\x35\51\40\x44\105\x46\x41\x55\x4c\124\x20\47\x62\x6f\144\171\x27"); $this->execute("\101\114\x54\x45\x52\x20\x54\x41\102\114\x45\x20\x78\160\x6c\x75\x67\x69\156\x5f\141\144\155\x6f\x72\162\x69\x73\x5f\160\x72\157\137\x63\157\157\153\151\x65\x5f\x6e\x6f\164\151\x63\x65\137\x70\162\x6f\40\101\x44\x44\x20\x73\x63\162\151\160\x74\103\157\x6e\x66\x69\x72\x6d\141\x74\x69\157\x6e\x50\x6f\163\x69\x74\151\157\156\40\126\101\122\x43\x48\101\122\x28\x32\65\x35\x29\x20\104\105\x46\101\x55\114\x54\40\x27\x62\x6f\144\171\x27"); $this->execute("\101\x4c\124\105\122\40\124\101\x42\114\105\40\170\x70\154\x75\x67\x69\x6e\x5f\141\144\155\x6f\x72\162\151\163\x5f\x70\x72\157\x5f\143\157\157\153\151\145\x5f\x6e\x6f\164\x69\x63\x65\x5f\160\x72\x6f\x20\101\104\104\40\143\157\157\x6b\x69\145\x50\165\162\x70\x6f\x73\145\40\166\141\162\143\150\x61\x72\50\62\x35\65\x29"); $cookieNotices = CookieNoticeProCookies::getAll(); $descriptions = CookieNoticeProDescriptions::getAll(); function findCookieDescriptionPurposeById($id, $arr) { $found = false; foreach ($arr as $item) { if (!($item->cookieId === $id)) { goto nnrGa; } $found = $item->cookiePurpose; nnrGa: aPsqF: } qPVsi: return $found; } $newObj = new stdClass(); goto YXqN2; jpFAb: foreach (CookieNoticeProCookies::getAll() as $cookie) { if (!isset($cookie->tconsentId)) { goto JY0Wd; } ConsentManagerIntegration::unregisterConsentItem($cookie->tconsentId); JY0Wd: ea_r1: } aU2wI: LiveChat::unregisterConsent(); GoogleCustomerReviews::unregisterConsent(); ShopVote::unregisterConsent(); $this->execute("\101\114\x54\105\122\x20\124\x41\x42\x4c\105\x20\x78\160\x6c\x75\x67\151\156\137\x61\144\x6d\x6f\x72\162\151\163\x5f\x70\x72\x6f\137\143\x6f\157\x6b\151\x65\x5f\x6e\157\x74\x69\x63\x65\x5f\x70\x72\157\x20\x44\x52\117\x50\40\164\143\x6f\156\163\x65\156\x74\x49\144"); $this->execute("\x41\114\124\x45\x52\40\x54\x41\102\x4c\x45\40\x78\160\x6c\165\147\x69\156\137\x61\x64\155\x6f\162\162\151\163\x5f\x70\162\157\137\143\157\x6f\153\151\145\137\x6e\157\x74\x69\x63\x65\x5f\x70\x72\157\40\104\x52\117\x50\40\150\151\x64\144\145\x6e\x4e\x61\155\145"); $this->execute("\x41\x4c\124\105\122\40\124\101\x42\114\105\x20\170\160\x6c\165\x67\151\x6e\137\141\x64\x6d\x6f\x72\162\151\163\137\160\162\157\x5f\x63\x6f\x6f\x6b\151\145\137\156\157\x74\151\x63\145\137\160\162\157\x20\104\122\117\120\x20\143\x6f\x6d\160\x61\156\171"); $this->execute("\x41\114\x54\x45\122\40\x54\x41\102\114\x45\x20\170\x70\154\x75\147\x69\x6e\137\x61\x64\x6d\157\x72\162\x69\163\137\160\x72\157\x5f\x63\x6f\x6f\x6b\x69\145\137\x6e\157\x74\151\x63\145\137\160\162\x6f\x5f\x64\145\x73\143\162\x69\160\164\151\x6f\156\x20\104\x52\x4f\120\x20\x70\x72\151\166\141\x63\x79\120\x6f\154\x69\x63\171"); $this->execute("\101\x4c\x54\x45\x52\40\x54\101\x42\114\x45\40\x78\160\x6c\x75\147\151\x6e\x5f\141\x64\155\157\x72\162\x69\163\137\160\162\x6f\x5f\143\157\157\153\x69\x65\x5f\156\x6f\164\x69\x63\145\137\160\162\x6f\40\x41\x44\x44\x20\143\x6f\157\153\x69\145\x44\145\146\x61\x75\x6c\x74\x20\124\x49\116\x59\x49\x4e\x54\x20\104\x45\106\101\125\114\124\x20\x30"); goto npf_W; YXqN2: $cookieNoticePurpose = null; foreach ($cookieNotices as $cookieNotice) { $cookieNoticePurpose = findCookieDescriptionPurposeById($cookieNotice->id, $descriptions); if (!$cookieNoticePurpose) { goto iEF0I; } $newObj = $cookieNotice; $newObj->cookiePurpose = $cookieNoticePurpose; unset($newObj->privacyPolicy); CookieNoticeProCookies::update($newObj); iEF0I: AAJFE: } YdUfI: $this->execute("\101\x4c\124\x45\x52\40\x54\x41\x42\114\105\40\170\x70\x6c\x75\147\151\x6e\137\x61\x64\x6d\x6f\x72\162\x69\163\x5f\x70\x72\157\137\x63\157\157\x6b\151\x65\137\156\157\x74\x69\x63\145\x5f\160\162\157\137\144\x65\163\x63\x72\151\160\164\x69\157\x6e\x20\x44\122\117\x50\40\143\x6f\x6f\x6b\x69\145\120\x75\162\160\157\x73\x65"); $this->execute("\x41\114\x54\x45\x52\x20\x54\101\102\114\x45\x20\x78\x70\154\x75\x67\x69\156\x5f\141\144\155\157\162\x72\x69\x73\x5f\160\x72\x6f\137\143\157\157\x6b\151\x65\x5f\x6e\x6f\x74\x69\143\x65\x5f\x70\x72\x6f\40\x41\104\104\x20\x73\x63\x72\x69\x70\x74\x41\154\154\x20\x54\x45\x58\x54\x20\x44\105\106\101\x55\x4c\x54\40\47\x27"); $this->execute("\x41\x4c\124\105\122\40\x54\x41\x42\x4c\105\x20\170\160\x6c\165\x67\151\x6e\x5f\141\x64\155\x6f\x72\162\151\x73\x5f\x70\x72\x6f\137\x63\x6f\157\153\151\x65\137\156\157\x74\x69\143\x65\x5f\x70\162\157\x20\x41\104\104\x20\x73\143\x72\151\x70\x74\x43\157\156\146\x69\162\155\141\x74\151\x6f\x6e\x20\124\x45\130\124"); $this->execute("\x44\x52\x4f\x50\40\124\x41\x42\114\x45\40\x78\x70\154\165\x67\151\156\137\x61\144\155\x6f\162\162\x69\163\137\160\x72\x6f\x5f\x63\x6f\x6f\153\151\145\137\x6e\157\x74\151\x63\145\x5f\160\x72\x6f\137\x74\x72\151\147\x67\x65\x72\x5f\x66\151\x6c\164\x65\x72\163"); $this->execute("\x44\122\x4f\120\40\124\101\x42\x4c\x45\x20\170\160\154\165\147\151\x6e\137\x61\x64\x6d\x6f\162\x72\x69\x73\x5f\x70\x72\x6f\137\143\157\x6f\153\151\x65\x5f\x6e\x6f\164\151\x63\145\137\x70\x72\x6f\137\x73\x63\x72\x69\x70\164\163"); $this->execute("\x44\x52\117\120\40\x54\x41\102\x4c\105\x20\x78\x70\x6c\x75\x67\x69\x6e\x5f\141\x64\x6d\x6f\x72\162\151\163\137\x70\162\x6f\137\143\157\157\x6b\x69\x65\x5f\156\157\164\151\143\x65\137\x70\x72\x6f\137\163\x65\164\x74\151\156\147\x73"); goto bLgUw; bLgUw: } }