<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\Migrations; use JTL\Plugin\Migration; use JTL\Update\IMigration; use JTL\Shop; class Migration20210528010100 extends Migration implements IMigration { protected $description = "\x41\144\144\x20\x54\x77\x69\x74\x63\x68\40\163\x6f\x63\151\x61\154\40\151\x63\x6f\156"; private $newIconType = "\x74\167\x69\164\143\x68"; public function up() { $iconsFile = file_get_contents(dirname(__FILE__) . "\x2f" . "\164\167\x69\164\x63\150\137\151\x63\x6f\156\137\163\143\141\154\x65\x64\137\x6f\x70\x74\151\155\x69\x7a\145\x64\56\x6a\x73\x6f\156"); $jsonIcons = json_decode($iconsFile); foreach ($jsonIcons as $categoryKey => $categories) { foreach ($categories as $iconTypesKey => $iconTypes) { foreach ($iconTypes as $iconFamilyKey => $iconFamilies) { foreach ($iconFamilies as $iconSvg) { $iconObj = new \stdClass(); $iconObj->category = $categoryKey; $iconObj->iconType = $iconTypesKey; $iconObj->iconFamily = $iconFamilyKey; $iconObj->pathOrSvg = $iconSvg; Shop::Container()->getDB()->insert("\170\x70\154\165\x67\151\x6e\x5f\x61\x64\x6d\157\162\162\x69\163\x5f\160\x72\157\137\x69\143\x6f\156\x73", $iconObj); d8WU9: } r0eK9: ecHIZ: } hVq7f: mxLCo: } sjxMN: BAOiz: } PR61u: $query = "\123\105\114\105\103\124\x20\52\40\x46\x52\x4f\115\40\x78\160\x6c\165\147\151\156\x5f\x61\144\155\x6f\162\162\x69\163\x5f\160\162\157\x5f\x69\x63\157\156\x73\x20\127\x48\105\122\105\40\151\x63\x6f\x6e\x54\171\x70\x65\x20\75\x20\72\151\143\157\x6e\x54\171\x70\x65\40\x41\x4e\x44\x20\x69\x63\157\156\x46\141\x6d\x69\154\171\40\x3d\40\x3a\151\x63\x6f\x6e\x46\141\x6d\151\x6c\x79"; $twitchIconsFA4 = Shop::Container()->getDB()->queryPrepared($query, ["\x69\x63\x6f\156\124\x79\160\x65" => $this->newIconType, "\151\x63\x6f\156\x46\x61\x6d\151\154\x79" => "\x66\x6f\156\x74\101\x77\145\163\x6f\x6d\x65\64"], 2); $data = new \stdClass(); $data->iconType = $twitchIconsFA4[0]->iconType; $data->iconId = $twitchIconsFA4[0]->iconId; $data->sizeMultiplier = "\x31"; $data->iconFamily = $twitchIconsFA4[0]->iconFamily; Shop::Container()->getDB()->insert("\x78\160\154\x75\147\x69\x6e\x5f\x61\x64\x6d\x6f\x72\162\151\163\137\x70\x72\157\137\x69\x63\157\x6e\163\137\165\163\x65\x64", $data); } public function down() { Shop::Container()->getDB()->delete("\170\x70\x6c\165\147\151\x6e\137\141\144\x6d\157\x72\162\x69\163\137\x70\162\x6f\x5f\151\x63\x6f\x6e\x73\x5f\x75\163\x65\x64", "\x69\x63\157\156\124\171\x70\145", $this->newIconType); $query = "\x53\105\x4c\x45\103\x54\x20\52\40\x46\x52\x4f\x4d\40\x78\x70\154\165\x67\x69\x6e\137\141\144\x6d\157\162\x72\151\x73\x5f\x70\162\157\137\x69\x63\157\x6e\x73\x20\127\x48\105\122\105\40\151\143\157\156\124\171\160\145\x20\75\x20\x3a\x69\143\x6f\x6e\124\x79\x70\145"; $twitchIcons = Shop::Container()->getDB()->queryPrepared($query, ["\x69\x63\x6f\x6e\x54\x79\160\145" => $this->newIconType], 2); foreach ($twitchIcons as $icon) { Shop::Container()->getDB()->delete("\x78\x70\x6c\x75\147\x69\x6e\137\x61\x64\x6d\x6f\162\x72\x69\163\x5f\160\x72\157\x5f\151\x63\157\x6e\x73", "\x69\x63\x6f\x6e\111\144", $icon->iconId); l0mV1: } BDgqb: } }