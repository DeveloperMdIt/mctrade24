<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\Migrations; use JTL\Plugin\Migration; use JTL\Update\IMigration; use JTL\Shop; class Migration20210426010100 extends Migration implements IMigration { protected $description = "\101\144\144\40\x6d\x69\163\x73\151\x6e\x67\x20\x49\x63\x6f\156\163\40\164\x6f\x20\111\143\157\156\x73\x20\x54\x61\x62\x6c\145"; protected $types = ["\x68\x6f\155\x65", "\x70\145\x6e\143\x69\x6c", "\154\157\x63\153", "\165\x6e\154\151\x6e\153"]; public function up() { $iconsFile = file_get_contents(dirname(__FILE__) . "\57" . "\x69\143\x6f\x6e\163\x32\x30\x32\x31\x30\64\x32\x36\137\163\x63\141\154\x65\144\x5f\157\x70\164\x69\155\x69\x7a\145\144\56\x6a\163\157\x6e"); $jsonIcons = json_decode($iconsFile); foreach ($jsonIcons as $categoryKey => $categories) { foreach ($categories as $iconTypesKey => $iconTypes) { foreach ($iconTypes as $iconFamilyKey => $iconFamilies) { foreach ($iconFamilies as $iconSvg) { $iconObj = new \stdClass(); $iconObj->category = $categoryKey; $iconObj->iconType = $iconTypesKey; $iconObj->iconFamily = $iconFamilyKey; $iconObj->pathOrSvg = $iconSvg; Shop::Container()->getDB()->insert("\170\x70\154\165\x67\151\x6e\x5f\141\144\155\x6f\162\x72\151\x73\x5f\160\x72\x6f\137\151\143\x6f\x6e\x73", $iconObj); FekXg: } yNAXU: vESlt: } L0Fy4: hEA4w: } TYfC5: wH5Ti: } hQRvC: foreach ($this->types as $type) { $query = "\123\x45\x4c\x45\103\124\40\x2a\x20\106\122\117\115\x20\170\x70\154\x75\x67\151\156\x5f\x61\144\x6d\157\162\x72\x69\163\137\160\x72\157\137\151\143\x6f\x6e\163\40\x57\x48\105\122\105\x20\x69\x63\x6f\x6e\124\171\160\x65\x20\x3d\40\72\x69\143\157\156\124\x79\x70\145\x20\x41\116\x44\40\x69\x63\x6f\x6e\106\141\x6d\x69\x6c\x79\x20\x3d\40\42\x66\157\156\x74\101\167\x65\163\157\155\145\x34\42"; $newIcons = Shop::Container()->getDB()->queryPrepared($query, ["\151\143\x6f\156\x54\x79\x70\145" => $type], 2); $data = new \stdClass(); $data->iconType = $newIcons[0]->iconType; $data->iconId = $newIcons[0]->iconId; $data->sizeMultiplier = "\61"; $data->iconFamily = $newIcons[0]->iconFamily; Shop::Container()->getDB()->insert("\170\160\x6c\165\147\x69\x6e\137\141\144\x6d\x6f\x72\162\151\x73\x5f\160\162\x6f\x5f\151\143\157\x6e\x73\x5f\x75\x73\x65\144", $data); RGGbX: } VNjAt: } public function down() { foreach ($this->types as $type) { Shop::Container()->getDB()->delete("\x78\160\x6c\x75\x67\151\x6e\x5f\141\x64\155\157\162\162\x69\163\137\x70\x72\157\137\151\143\x6f\x6e\x73\x5f\165\x73\145\144", "\x69\143\x6f\x6e\x54\171\160\145", $type); DVpSE: } f13me: foreach ($this->types as $type) { $query = "\123\x45\x4c\x45\103\x54\40\52\40\106\x52\117\x4d\40\170\160\x6c\165\x67\x69\x6e\137\141\144\155\157\162\x72\151\x73\137\x70\162\157\x5f\151\143\x6f\156\x73\40\x57\x48\105\x52\x45\40\x69\143\157\x6e\x54\171\x70\145\40\75\40\x3a\x69\x63\157\156\124\x79\x70\x65"; $delIcons = Shop::Container()->getDB()->queryPrepared($query, ["\x69\x63\x6f\156\124\171\160\145" => $type], 2); foreach ($delIcons as $icon) { Shop::Container()->getDB()->delete("\x78\160\x6c\x75\147\151\x6e\x5f\141\x64\x6d\x6f\162\162\151\163\x5f\160\x72\x6f\x5f\x69\x63\157\x6e\x73", "\x69\143\157\x6e\111\x64", $icon->iconId); t3Sfu: } lO33r: mEgZS: } Jd7Fi: } }