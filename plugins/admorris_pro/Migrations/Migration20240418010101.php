<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro\Migrations; use JTL\Plugin\Migration; use JTL\Shop; use JTL\Update\IMigration; class Migration20240418010101 extends Migration implements IMigration { protected $description = "\124\x72\x61\x6e\163\146\x65\162\40\x6f\x6c\x64\x20\141\146\146\x69\x78\x20\x73\x65\x74\x74\x69\156\x67\163\x20\x74\157\40\x6e\x65\x77\40\x73\164\151\143\153\x79\x20\163\x65\164\164\151\x6e\147\163"; public function up() { $templateSettings = $this->db->select("\x78\x70\x6c\165\147\151\x6e\x5f\141\144\x6d\x6f\162\x72\151\x73\137\x70\162\x6f\137\164\145\x6d\x70\x6c\x61\164\145\137\x73\145\x74\164\x69\x6e\147\x73", "\151\x64", 1); $nativeTemplateSettings = $this->db->selectAll("\164\164\145\155\160\x6c\141\x74\145\145\x69\156\163\164\145\154\x6c\165\x6e\147\x65\x6e", "\143\x54\145\155\x70\154\x61\x74\145", "\141\144\155\x6f\x72\x72\x69\163\137\x70\x72\x6f"); $themeVars = $this->db->select("\170\160\x6c\x75\x67\151\156\x5f\141\144\x6d\157\162\x72\151\x73\137\160\x72\x6f\137\164\x68\145\155\x65", "\151\x64", (int) $templateSettings->themeId); if (!(empty($templateSettings) || empty($nativeTemplateSettings) || empty($themeVars))) { goto vZw3I; } return; vZw3I: $themeVarsData = json_decode($themeVars->data); $settingNames = [["\156\x61\166\142\x61\162\101\146\146\x69\x78\103\157\154\157\x72", "\150\145\x61\x64\x65\162\122\157\167\x53\x74\x69\x63\153\x79\103\x6f\x6c\157\162\62"], ["\156\141\x76\x62\141\x72\101\x66\x66\151\170\102\x67", "\x68\145\x61\144\x65\162\122\157\167\123\x74\151\143\x6b\x79\x42\147\x32"], ["\156\x61\x76\142\141\162\x41\146\146\151\x78\103\x6f\154\x6f\162\115\x6f\x62\x69\154\x65", "\x68\x65\141\x64\x65\x72\x52\x6f\167\x53\x74\151\x63\153\171\x43\x6f\154\157\162\115\157\x62\151\154\145\x32"], ["\156\x61\166\x62\x61\162\101\x66\x66\x69\x78\x42\x67\115\x6f\x62\151\x6c\145", "\150\x65\141\144\x65\162\x52\157\167\123\x74\x69\x63\153\171\x42\x67\115\157\142\151\x6c\x65\62"]]; foreach ($settingNames as $settingName) { $themeVarsData->{$settingName[1]} = $themeVarsData->{$settingName[0]}; unset($themeVarsData->{$settingName[0]}); CAYdj: } Zs2nJ: foreach ($nativeTemplateSettings as $setting) { if (!($setting->cName === "\163\164\141\x74\151\143\137\x68\145\x61\x64\145\x72")) { goto nVyiE; } $themeVarsData->headerRowSticky2 = $setting->cWert === "\x59" ? true : false; $themeVarsData->headerRowStickyMobile2 = $setting->cWert === "\x59" ? true : false; goto qEYk_; nVyiE: T1fdH: } qEYk_: $themeVars->data = json_encode($themeVarsData); $themeVars->id = (int) $themeVars->id; $this->db->upsert("\170\160\x6c\x75\147\x69\x6e\x5f\x61\x64\x6d\157\x72\162\x69\x73\x5f\160\x72\157\137\164\150\x65\155\x65", $themeVars); } public function down() { } }