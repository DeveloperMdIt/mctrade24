<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro; use JTL\Shop; function get_mailchimp_connection_data() { goto OLC3Y; OLC3Y: $domain = parse_url(Shop::getURL(), PHP_URL_HOST); $domain_without_www = str_replace("\167\167\x77\x2e", '', $domain); $url = $domain; $main_domain = Shop::Container()->getDB()->select("\x74\x70\154\165\147\151\x6e\x65\151\x6e\x73\x74\145\154\x6c\x75\x6e\147\145\156", "\143\116\141\155\145", "\141\x64\155\157\162\x72\151\163\137\160\x72\157\137\163\145\141\x72\143\150\x5f\155\x61\151\156\137\144\157\x6d\141\x69\x6e"); $main_domain = $main_domain->cWert; if (empty($main_domain)) { goto mbBzT; } $domain_without_www = $main_domain; mbBzT: $store = str_replace("\x2e", "\137", $domain_without_www); $store = str_replace("\x2f", '', $store); goto gQoLb; y_xuF: return $data; goto y0qrw; gQoLb: $store = str_replace("\141\x64\155\x69\156", '', $store); $listID = Shop::Container()->getDB()->select("\164\160\x6c\165\x67\x69\x6e\x65\x69\156\163\164\145\154\x6c\165\x6e\147\145\x6e", "\x63\116\141\x6d\x65", "\x61\x64\x6d\x6f\x72\162\x69\163\x5f\160\x72\157\137\155\141\162\153\145\164\x69\x6e\147\x5f\x6d\141\151\x6c\143\x68\151\x6d\x70\137\154\151\163\164\137\x69\144"); $listID = $listID->cWert; $api_key = Shop::Container()->getDB()->select("\164\160\x6c\x75\147\x69\156\x65\x69\156\163\164\145\154\154\165\156\x67\145\156", "\x63\x4e\x61\x6d\x65", "\141\x64\155\x6f\x72\x72\151\x73\x5f\160\162\157\137\155\141\x72\153\145\164\151\x6e\147\x5f\x6d\141\x69\154\143\150\x69\155\x70\137\x61\160\x69\x5f\x6b\145\x79"); $api_key = $api_key->cWert; $data = new \stdClass(); $data->api_key = $api_key; $data->listID = $listID; $data->store = $store; $data->url = $url; goto y_xuF; y0qrw: } function rudr_mailchimp_curl_connect($url, $request_type, $api_key, $data = array()) { if (!($request_type == "\107\x45\124")) { goto eBOus; } $url .= "\x3f" . http_build_query($data); eBOus: $mch = curl_init(); $headers = array("\103\157\156\164\x65\156\164\55\x54\171\x70\x65\72\x20\141\160\160\154\151\x63\x61\164\151\x6f\156\57\152\163\x6f\x6e", "\101\x75\x74\150\x6f\162\151\172\141\x74\151\x6f\156\x3a\40\x42\141\163\x69\x63\40" . base64_encode("\x75\x73\x65\162\72" . $api_key)); curl_setopt($mch, CURLOPT_URL, $url); curl_setopt($mch, CURLOPT_HTTPHEADER, $headers); curl_setopt($mch, CURLOPT_RETURNTRANSFER, true); curl_setopt($mch, CURLOPT_CUSTOMREQUEST, $request_type); curl_setopt($mch, CURLOPT_TIMEOUT, 10); curl_setopt($mch, CURLOPT_SSL_VERIFYPEER, false); if (!($request_type != "\x47\105\124")) { goto F1UD0; } curl_setopt($mch, CURLOPT_POST, true); curl_setopt($mch, CURLOPT_POSTFIELDS, json_encode($data)); F1UD0: return curl_exec($mch); } function rudr_mailchimp_subscribe_unsubscribe($email, $status, $language, $merge_fields = array("\x46\116\101\115\x45" => '', "\114\x4e\101\115\105" => '', "\x52\x45\127\101\122\104\x50" => '', "\102\x49\x52\x54\x48\104" => '', "\103\x47\122\117\x55\120" => '', "\x47\105\116\x44\105\x52" => '')) { $list_id = Shop::Container()->getDB()->select("\x74\160\x6c\165\147\151\x6e\145\x69\x6e\x73\x74\x65\154\x6c\x75\156\x67\145\x6e", "\x63\116\x61\x6d\145", "\141\144\155\157\x72\162\x69\163\137\160\x72\x6f\x5f\x6d\x61\162\153\145\x74\x69\156\x67\x5f\x6d\141\x69\x6c\143\150\x69\x6d\160\137\x6c\x69\163\164\x5f\151\144"); $list_id = $list_id->cWert; $api_key = Shop::Container()->getDB()->select("\x74\160\154\x75\x67\151\x6e\145\x69\x6e\x73\x74\x65\154\x6c\165\x6e\147\x65\x6e", "\143\x4e\x61\155\x65", "\141\144\x6d\157\x72\162\151\x73\137\x70\x72\157\137\x6d\141\x72\x6b\x65\164\x69\156\147\x5f\155\x61\151\154\x63\150\x69\x6d\160\137\141\x70\x69\137\x6b\145\x79"); $api_key = $api_key->cWert; $url = "\x68\x74\164\x70\x73\72\x2f\x2f" . substr($api_key, strpos($api_key, "\x2d") + 1) . "\x2e\141\x70\x69\56\155\141\151\154\x63\150\x69\155\x70\x2e\x63\x6f\x6d\x2f\x33\56\x30\x2f\154\x69\163\x74\163\57" . $list_id . "\57\x6d\145\155\142\x65\x72\x73\57" . md5(strtolower($email)); $data = array("\x61\x70\x69\x6b\x65\x79" => $api_key, "\145\x6d\x61\x69\x6c\137\141\144\144\x72\x65\163\x73" => $email, "\163\164\x61\164\x75\x73" => $status, "\x6c\141\x6e\x67\165\x61\x67\145" => $language, "\x6d\145\x72\147\x65\137\146\151\145\154\x64\163" => $merge_fields); $data = array_filter($data); return json_decode(rudr_mailchimp_curl_connect($url, "\120\x55\x54", $api_key, $data)); }