<?php
/*   __________________________________________________
    |  Copyright by admorris.pro  |
    |__________________________________________________|
*/
 namespace Plugin\admorris_pro; use JTL\DB\ReturnType; use JTL\Shop; use Plugin\admorris_pro\ioHandling\rewardPoints\RewardPointsTransaction; use Plugin\admorris_pro\Logger; use function Plugin\admorris_pro\container; if (!($oPlugin->getConfig()->getValue("\141\x64\x6d\157\x72\x72\151\163\x5f\x70\162\157\137\x6d\141\162\x6b\145\164\151\156\x67\x5f\x6d\141\x69\154\143\x68\151\x6d\160\x5f\141\143\164\151\x76\x65") === "\x59")) { goto pXXT3; } require_once $oPlugin->getPaths()->getFrontendPath() . "\155\x61\x69\x6c\143\150\x69\x6d\160\57\143\x6f\156\156\145\x63\164\x69\157\156\x2e\160\150\x70"; if (!(isset($args_arr["\157\116\145\167\163\154\145\164\164\145\162\105\155\x70\x66\x61\145\156\x67\x65\162"]) && is_object($args_arr["\x6f\116\x65\x77\163\154\x65\164\x74\145\162\105\155\x70\146\141\x65\156\x67\145\x72"]))) { goto FSDj5; } $oNewsletterEmpfaenger = $args_arr["\x6f\116\x65\x77\x73\x6c\x65\164\x74\x65\162\105\155\160\x66\x61\x65\156\x67\145\x72"]; $lang = Shop::Container()->getDB()->select("\x74\163\x70\162\141\143\150\x65", "\x6b\x53\160\x72\141\143\x68\x65", $oNewsletterEmpfaenger->kSprache); if ($lang->cISO == "\147\x65\162") { goto BaMaX; } if ($lang->cISO == "\x65\x6e\x67") { goto feOZL; } if ($lang->cISO == "\151\x74\x61") { goto SKmEq; } if ($lang->cISO == "\x66\162\145") { goto bIJoS; } if ($lang->cISO == "\x73\160\141") { goto tzwmc; } $lang = ''; goto gJYbf; tzwmc: $lang = "\x65\163"; gJYbf: goto PK7CQ; bIJoS: $lang = "\x66\x72"; PK7CQ: goto SUSjq; SKmEq: $lang = "\151\x74"; SUSjq: goto BCiZl; feOZL: $lang = "\145\156"; BCiZl: goto QDb0J; BaMaX: $lang = "\144\145"; QDb0J: if ($oNewsletterEmpfaenger->kKunde != "\60") { goto W6NVY; } $subscription = rudr_mailchimp_subscribe_unsubscribe($oNewsletterEmpfaenger->cEmail, "\x73\x75\142\x73\143\x72\x69\142\145\144", $lang, array("\106\x4e\x41\x4d\x45" => $oNewsletterEmpfaenger->cVorname, "\x4c\x4e\x41\115\x45" => $oNewsletterEmpfaenger->cNachname, "\107\105\x4e\x44\x45\x52" => $oNewsletterEmpfaenger->cAnrede)); goto QD3M5; W6NVY: $getData = Shop::Container()->getDB()->getSingleObject("\123\x45\x4c\x45\x43\124\40\153\113\x75\156\144\x65\x6e\147\x72\165\x70\x70\x65\x2c\40\144\x47\x65\x62\165\162\164\163\x74\x61\x67\x20\106\x52\117\115\40\164\x6b\x75\156\x64\x65\40\x57\110\x45\122\x45\40\153\x4b\165\156\x64\145\40\x3d\x20{$oNewsletterEmpfaenger->kKunde}\40\x4c\x49\115\111\124\40\x31"); $dGeburtstag = date("\155\57\144", strtotime($getData->dGeburtstag)); $kundenGruppenID = $getData->kKundengruppe; $getKundengruppe = Shop::Container()->getDB()->query("\x53\105\114\x45\x43\124\x20\143\x4e\141\155\145\40\x46\122\117\115\x20\164\153\x75\156\144\x65\156\x67\x72\165\160\160\145\40\127\110\105\122\105\40\153\x4b\165\x6e\144\145\x6e\x67\x72\165\160\x70\x65\x20\x3d\x20{$kundenGruppenID}\x20\x4c\x49\x4d\x49\x54\x20\x31", ReturnType::SINGLE_OBJECT); $kundengruppeName = $getKundengruppe->cName; $actualRewardPoints = RewardPointsTransaction::getCustomerRewardPoints((int) $oNewsletterEmpfaenger->kKunde)->valid_points; $subscription = rudr_mailchimp_subscribe_unsubscribe($oNewsletterEmpfaenger->cEmail, "\x73\165\x62\163\143\162\x69\142\145\144", $lang, array("\106\116\x41\x4d\x45" => $oNewsletterEmpfaenger->cVorname, "\114\x4e\x41\x4d\105" => $oNewsletterEmpfaenger->cNachname, "\x42\111\x52\x54\110\x44" => $dGeburtstag, "\103\107\x52\117\125\120" => $kundengruppeName, "\x47\x45\116\104\x45\122" => $oNewsletterEmpfaenger->cAnrede, "\x52\x45\x57\x41\x52\x44\x50" => $actualRewardPoints)); QD3M5: $log = container()->make(Logger::class)->debug("\141\144\x6d\x6f\x72\x72\151\163\x20\x50\x72\x6f\x20\x2d\40\123\x42\40\x4d\141\151\x6c\143\x68\x69\155\160\x20\120\101\x54\103\110\x20\x70\162\157\144\165\143\x74\x3a\40" . print_r($subscription, true)); FSDj5: pXXT3: